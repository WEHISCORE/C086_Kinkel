<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set</title>
  
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-03-27"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-03-27"/>
  <meta name="article:author" content="Peter Hickey"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="C086"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"/>
  
  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","editor_options","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Peter Hickey"]},{"type":"character","attributes":{},"value":["https://peterhickey.org"]},{"type":"character","attributes":{},"value":["WEHI SCORE"]},{"type":"character","attributes":{},"value":["https://www.wehi.edu.au/people/shalin-naik/3310/score"]}]}]},{"type":"character","attributes":{},"value":["2021-03-27"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"character","attributes":{},"value":["ref.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>
  
  <script type="application/javascript">
  
    window.headroom_prevent_pin = false;
  
    window.document.addEventListener("DOMContentLoaded", function (event) {
  
      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');
  
      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });
  
      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });
  
      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>
  
  <style type="text/css">
  
  /* Theme (user-documented overrideables for nav appearance) */
  
  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }
  
  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }
  
  .distill-site-nav a:hover {
    color: white;
  }
  
  @media print {
    .distill-site-nav {
      display: none;
    }
  }
  
  .distill-site-header {
  
  }
  
  .distill-site-footer {
  
  }
  
  
  /* Site Header */
  
  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }
  
  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }
  
  
  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }
  
  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }
  
  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }
  
  .distill-site-header .logo {
    padding: 0;
  }
  
  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }
  
  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }
  
  
  
  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }
  
  
  .distill-site-header .nav-toggle {
    display: none;
  }
  
  .nav-dropdown {
    display: inline-block;
    position: relative;
  }
  
  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }
  
  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }
  
  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .nav-dropdown-active {
    display: block;
  }
  
  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }
  
  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }
  
  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }
  
  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }
  
  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }
  
  /* Site Footer */
  
  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }
  
  /* Headroom */
  
  d-title {
    padding-top: 6rem;
  }
  
  @media print {
    d-title {
      padding-top: 4rem;
    }
  }
  
  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }
  
  .headroom--transition {
    transition: all .4s ease-in-out;
  }
  
  .headroom--unpinned {
    top: -100px;
  }
  
  .headroom--pinned {
    top: 0;
  }
  
  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }
  
  </style>
  
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>
  
  <script type="application/javascript">
  
  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }
  
  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }
  
  function createFuseIndex() {
  
    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);
  
    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });
  
        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }
  
  window.document.addEventListener("DOMContentLoaded", function (event) {
  
    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;
  
    createFuseIndex()
      .then(function(fuse) {
  
        // make search box visible
        searchEl.classList.remove('hidden');
  
        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });
  
  });
  
  </script>
  
  <style type="text/css">
  
  .nav-search {
    font-size: x-small;
  }
  
  /* Algolioa Autocomplete */
  
  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }
  
  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }
  
  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }
  
  </style>
  
  
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set","authors":[{"author":"Peter Hickey","authorURL":"https://peterhickey.org","affiliation":"WEHI SCORE","affiliationURL":"https://www.wehi.edu.au/people/shalin-naik/3310/score","orcidID":""}],"publishedDate":"2021-03-27T00:00:00.000+11:00","citationText":"Hickey, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">C086</a>
<a href="index.html">Introduction</a>
<a href="C086_Kinkel.preprocess.html">Preprocessing</a>
<a href="C086_Kinkel.multi-sample_comparisons.html">Differential analyses</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Supplementary files
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../output/scPipe/">scPipe reports</a>
<a href="../output/DEGs/">Differentially expressed genes</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="https://github.com/WEHISCORE/C086_Kinkel">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Peter Hickey <a href="https://peterhickey.org" class="uri">https://peterhickey.org</a> (WEHI SCORE)<a href="https://www.wehi.edu.au/people/shalin-naik/3310/score" class="uri">https://www.wehi.edu.au/people/shalin-naik/3310/score</a>
  
<br/>2021-03-27
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#setup">Setup</a><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#load-data">Load data</a></li>
<li><a href="#create-dgelist-objects">Create DGEList objects</a></li>
<li><a href="#gene-filtering">Gene filtering</a></li>
<li><a href="#normalization">Normalization</a></li>
</ul></li>
<li><a href="#analysis-of-individuals-tech-reps">Analysis of individuals tech reps</a><ul>
<li><a href="#mds">MDS</a><ul>
<li><a href="#after-excluding-outliers">After excluding outliers</a></li>
</ul></li>
<li><a href="#array-weights">Array weights</a></li>
<li><a href="#de-analysis">DE analysis</a></li>
</ul></li>
<li><a href="#analysis-of-aggregated-tech-reps">Analysis of aggregated tech reps</a><ul>
<li><a href="#mds-1">MDS</a></li>
<li><a href="#array-weights-1">Array weights</a><ul>
<li><a href="#comparison-to-individual-tech-reps">Comparison to individual tech reps</a></li>
</ul></li>
<li><a href="#de-analysis-1">DE analysis</a><ul>
<li><a href="#gene-set-tests">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#male-only-analysis-of-aggregated-tech-reps">Male-only: analysis of aggregated tech reps</a><ul>
<li><a href="#mds-2">MDS</a></li>
<li><a href="#array-weights-2">Array weights</a></li>
<li><a href="#de-analysis-2">DE analysis</a><ul>
<li><a href="#gene-set-tests-1">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#female-only-analysis-of-aggregated-tech-reps">Female-only: analysis of aggregated tech reps</a><ul>
<li><a href="#mds-3">MDS</a></li>
<li><a href="#array-weights-3">Array weights</a></li>
<li><a href="#de-analysis-3">DE analysis</a><ul>
<li><a href="#gene-set-tests-2">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#todos">TODOs</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</nav>
</div>
<h1 id="setup">Setup</h1>
<h2 id="summary">Summary</h2>
<ul>
<li>Read counts analysed</li>
<li>Various analyses denoted by a prefix (<code>x</code>, <code>y</code>, <code>ym</code>, <code>yf</code>)
<ul>
<li><code>x</code>: <code>voomLmFit()</code> of individual technical replicates, blocking on mouse</li>
<li><code>y</code>: <code>voomLmFit()</code> of aggregated technical reps</li>
<li><code>ym</code>: As with <code>y</code> but <strong>males</strong> only</li>
<li><code>yf</code>: As with <code>y</code> but <strong>females</strong> only</li>
</ul></li>
</ul>
<h2 id="load-data">Load data</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SingleCellExperiment</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://bioinf.wehi.edu.au/edgeR'>edgeR</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/helper_functions.R"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>sce</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"SCEs"</span>, <span class='st'>"C086_Kinkel.preprocessed.SCE.rds"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Some useful colours</span>
<span class='va'>sex_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>sex_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>sex_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>smchd1_genotype_updated_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mouse_number_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>mouse_number_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>mouse_number_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="create-dgelist-objects">Create DGEList objects</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></span><span class='op'>(</span>
  counts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>sce</span>, <span class='st'>"read_counts"</span><span class='op'>)</span><span class='op'>)</span>,
  samples <span class='op'>=</span> <span class='fu'>colData</span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>,
  group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated</span><span class='op'>)</span>,
  genes <span class='op'>=</span> <span class='fu'>flattenDF</span><span class='op'>(</span><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>!</span><span class='fu'>matrixStats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/rowAlls.html'>rowAlls</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>counts</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/sumTechReps.html'>sumTechReps</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>genotype.mouse</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sex</span> <span class='op'>==</span> <span class='st'>"M"</span><span class='op'>]</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sex</span> <span class='op'>==</span> <span class='st'>"F"</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h2 id="gene-filtering">Gene filtering</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>x</span>, group <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>x_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>x_keep_exprs
FALSE  TRUE 
10124 15462 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>x_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>y</span>, group <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>y_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>y_keep_exprs
FALSE  TRUE 
 6634 18952 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='va'>y_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>ym</span>, group <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>ym_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>ym_keep_exprs
FALSE  TRUE 
 8338 17248 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='va'>ym</span><span class='op'>[</span><span class='va'>ym_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>yf</span>, group <span class='op'>=</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>yf_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>yf_keep_exprs
FALSE  TRUE 
10977 14609 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='va'>yf</span><span class='op'>[</span><span class='va'>yf_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h2 id="normalization">Normalization</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>ym</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>yf</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="analysis-of-individuals-tech-reps">Analysis of individuals tech reps</h1>
<h2 id="mds">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>x</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>x_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>x_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<h3 id="after-excluding-outliers">After excluding outliers</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>outliers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Del.1282.2"</span>, <span class='st'>"Het.1248.2"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<ul>
<li>Exclude Del.1282.2, Het.1248.2</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='va'>outliers</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>x2_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>x2</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>x2_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x2_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>x2_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>x2</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x2</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h2 id="array-weights">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span> <span class='op'>+</span> <span class='va'>sex</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x_design</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  design <span class='op'>=</span> <span class='va'>x_design</span>,
  block <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>mouse_number</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<ul>
<li><strong>TODO</strong>: How to interpret small intra-block correlation (<code>x_fit$cor</code> = 0.0201805)?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_aw</span> <span class='op'>&lt;-</span> <span class='va'>x_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>x_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>x_aw</span> <span class='op'>&lt;-</span> <span class='va'>x_aw</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span>
  <span class='va'>x_aw</span>,
  col <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>,
  las <span class='op'>=</span> <span class='fl'>2</span>,
  cex.names <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<h2 id="de-analysis">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>x_design</span><span class='op'>)</span>
<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>x_fit</span>, <span class='va'>x_contrasts</span><span class='op'>)</span>
<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>x_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>x_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     15452
Up            10</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>x_fit</span>, status <span class='op'>=</span> <span class='va'>x_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, main <span class='op'>=</span> <span class='st'>"Del - Het"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                        ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Gm10925              unprocessed_pseudogene          Gm10925
Gm6472     transcribed_processed_pseudogene           Gm6472
Rpl31-ps8              processed_pseudogene        Rpl31-ps8
Rps4x                        protein_coding            Rps4x
Rps7                         protein_coding             Rps7
mt-Nd1                       protein_coding           mt-Nd1
Gm10275    transcribed_processed_pseudogene          Gm10275
Plac8                        protein_coding            Plac8
Gm15793                processed_pseudogene          Gm15793
Rpl36a-ps1             processed_pseudogene       Rpl36a-ps1
           ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Gm10925                24613974           24614651               1
Gm6472                152909505          152910155               X
Rpl31-ps8              90764279           90764656              15
Rps4x                 102184941          102189394               X
Rps7                   28630847           28635953              12
mt-Nd1                     2751               3707              MT
Gm10275                29698746           29699380              10
Plac8                 100553725          100572245               5
Gm15793                66849108           66849602               1
Rpl36a-ps1             98993980           98994300              14
           ENSEMBL.SYMBOL        ENSEMBL.GENEID
Gm10925           Gm10925  ENSMUSG00000100862.1
Gm6472             Gm6472  ENSMUSG00000095597.2
Rpl31-ps8       Rpl31-ps8  ENSMUSG00000067870.5
Rps4x               Rps4x  ENSMUSG00000031320.9
Rps7                 Rps7  ENSMUSG00000061477.4
mt-Nd1             mt-Nd1  ENSMUSG00000064341.1
Gm10275           Gm10275  ENSMUSG00000069682.6
Plac8               Plac8 ENSMUSG00000029322.12
Gm15793           Gm15793  ENSMUSG00000082769.3
Rpl36a-ps1     Rpl36a-ps1  ENSMUSG00000060377.4
                                        NCBI.ALIAS NCBI.ENTREZID
Gm10925    Atp6; Atpase6; Mtatp6; mt-Atp6; Gm10925     100503946
Gm6472                  EG624124; Gm6472; Rps7-ps3        624124
Rpl31-ps8                                       NA            NA
Rps4x                  R; Rps; Rps4; Rps4-1; Rps4x         20102
Rps7                       Mtu; Rps7A; S; S7; Rps7         20115
mt-Nd1                                         ND1         17716
Gm10275                                    Gm10275         19897
Plac8           C15; D5Wsu111; D5Wsu111e; o; Plac8        231507
Gm15793                                         NA            NA
Rpl36a-ps1                     Gm10077; Rpl36a-ps1     100043787
                                  NCBI.GENENAME
Gm10925    ATP synthase F0 subunit 6 pseudogene
Gm6472       ribosomal protein S7, pseudogene 3
Rpl31-ps8                                    NA
Rps4x            ribosomal protein S4, X-linked
Rps7                       ribosomal protein S7
mt-Nd1             NADH dehydrogenase subunit 1
Gm10275                        Rpl12 pseudogene
Plac8                       placenta-specific 8
Gm15793                                      NA
Rpl36a-ps1 ribosomal protein L36A, pseudogene 1
                                                                                                                                                                                            NCBI.REFSEQ
Gm10925                                                                                                                                                                                              NA
Gm6472                                                                                                                                                                                               NA
Rpl31-ps8                                                                                                                                                                                            NA
Rps4x                                                                                                                                                  NM_009094; NP_033120; XM_011247553; XP_011245855
Rps7                                                                                                                                                                               NM_011300; NP_035430
mt-Nd1                                                                                                                                                                                        NP_904328
Gm10275                                                                                                                                                                                    NM_001134869
Plac8      NM_001370754; NM_139198; NP_001357683; NP_631937; XM_017320849; XM_017320850; XM_030254402; XM_030254403; XM_030254404; XP_017176338; XP_017176339; XP_030110262; XP_030110263; XP_030110264
Gm15793                                                                                                                                                                                              NA
Rpl36a-ps1                                                                                                                                                                                           NA
           NCBI.SYMBOL     logFC   AveExpr         t      P.Value
Gm10925        Gm10925 0.3636613 13.583299 12.282923 2.471878e-14
Gm6472        Rps7-ps3 0.2847321 11.416093  6.805169 6.395772e-08
Rpl31-ps8           NA 0.3053303 10.893213  5.519274 3.196328e-06
Rps4x            Rps4x 0.3161250 11.569869  5.522743 3.162626e-06
Rps7              Rps7 0.2728438  8.663003  4.979994 1.654151e-05
mt-Nd1             ND1 0.2760025 11.922707  5.490450 3.490651e-06
Gm10275        Gm10275 0.3292183  9.906238  4.973225 1.688488e-05
Plac8            Plac8 1.4396497  4.767396  4.689288 3.984069e-05
Gm15793             NA 0.2906575 11.620922  5.226212 7.820511e-06
Rpl36a-ps1  Rpl36a-ps1 0.2757738  9.735517  4.847399 2.472205e-05
              adj.P.Val         B
Gm10925    3.822018e-10 19.044385
Gm6472     4.944571e-04  6.884446
Rpl31-ps8  1.079449e-02  3.286937
Rps4x      1.079449e-02  2.860856
Rps7       2.900822e-02  2.575890
mt-Nd1     1.079449e-02  2.557637
Gm10275    2.900822e-02  2.124062
Plac8      5.600153e-02  2.087144
Gm15793    2.015346e-02  1.911894
Rpl36a-ps1 3.822524e-02  1.823869</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
           logFC  AveExpr         t      P.Value  adj.P.Val        B
Smchd1 -1.192231 5.994756 -4.330564 0.0001164031 0.09999029 1.171171</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, 
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<h1 id="analysis-of-aggregated-tech-reps">Analysis of aggregated tech reps</h1>
<h2 id="mds-1">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>y</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>y_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>y_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<h2 id="array-weights-1">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span> <span class='op'>+</span> <span class='va'>sex</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>y</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_aw</span> <span class='op'>&lt;-</span> <span class='va'>y_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>y_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='va'>y_aw</span> <span class='op'>&lt;-</span> <span class='va'>y_aw</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>y_aw</span>, col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<h3 id="comparison-to-individual-tech-reps">Comparison to individual tech reps</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span>
  <span class='va'>x_aw</span>,
  col <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>,
  las <span class='op'>=</span> <span class='fl'>2</span>,
  cex.names <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>y_aw</span>, col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-1">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>y_design</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>y_fit</span>, <span class='va'>y_contrasts</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>y_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>y_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     18952
Up             0</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>y_fit</span>, status <span class='op'>=</span> <span class='va'>y_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                     ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Stat2                     protein_coding            Stat2
Gm6472  transcribed_processed_pseudogene           Gm6472
Klhl24                    protein_coding           Klhl24
Mrpl3                     protein_coding            Mrpl3
Ube2l3                    protein_coding           Ube2l3
Smchd1                    protein_coding           Smchd1
Rab2b                     protein_coding            Rab2b
Cyc1                      protein_coding             Cyc1
Fam188a                   protein_coding          Fam188a
Aldh9a1                   protein_coding          Aldh9a1
        ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Stat2              128270576          128292849              10
Gm6472             152909505          152910155               X
Klhl24              20097554           20127744              16
Mrpl3              105053239          105079888               9
Ube2l3              17152013           17202649              16
Smchd1              71344489           71475343              17
Rab2b               52261759           52279545              14
Cyc1                76343523           76345934              15
Fam188a             12347263           12419470               2
Aldh9a1            167349991          167368532               1
        ENSEMBL.SYMBOL        ENSEMBL.GENEID
Stat2            Stat2 ENSMUSG00000040033.16
Gm6472          Gm6472  ENSMUSG00000095597.2
Klhl24          Klhl24  ENSMUSG00000062901.3
Mrpl3            Mrpl3 ENSMUSG00000032563.16
Ube2l3          Ube2l3 ENSMUSG00000038965.17
Smchd1          Smchd1 ENSMUSG00000024054.14
Rab2b            Rab2b ENSMUSG00000022159.16
Cyc1              Cyc1  ENSMUSG00000022551.8
Fam188a        Fam188a ENSMUSG00000026767.12
Aldh9a1        Aldh9a1 ENSMUSG00000026687.14
                                                                                     NCBI.ALIAS
Stat2                                                            1600010G07Rik; AW496480; Stat2
Gm6472                                                               EG624124; Gm6472; Rps7-ps3
Klhl24                              1110046J11Rik; 4930429H24Rik; 6530402O20Rik; C85082; Klhl24
Mrpl3                              2010320L16Rik; 5930422H18Rik; AA407889; L3mt; dc; dcr; Mrpl3
Ube2l3                                                             C79827; UbcM4; Ubce7; Ube2l3
Smchd1                              4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
Rab2b                            1500012D09Rik; 4930528G15Rik; A230002G14; D530043M21Rik; Rab2b
Cyc1                                                       2610002H19Rik; AA408921; Cyct1; Cyc1
Fam188a 1810041E18Rik; 2310047O13Rik; 5830410F13Rik; AI447827; AW111958; Fam18; Fam188a; Mindy3
Aldh9a1                     AA139417; Abaldh; ESTM4; ESTM40; TMABA-; TMABA-DH; Tmabadh; Aldh9a1
        NCBI.ENTREZID
Stat2           20847
Gm6472         624124
Klhl24          75785
Mrpl3           94062
Ube2l3          22195
Smchd1          74355
Rab2b           76338
Cyc1            66445
Fam188a         66960
Aldh9a1         56752
                                             NCBI.GENENAME
Stat2   signal transducer and activator of transcription 2
Gm6472                  ribosomal protein S7, pseudogene 3
Klhl24                                       kelch-like 24
Mrpl3                   mitochondrial ribosomal protein L3
Ube2l3                  ubiquitin-conjugating enzyme E2L 3
Smchd1                       SMC hinge domain containing 1
Rab2b                    RAB2B, member RAS oncogene family
Cyc1                                        cytochrome c-1
Fam188a                   MINDY lysine 48 deubiquitinase 3
Aldh9a1             aldehyde dehydrogenase 9, subfamily A1
                                                                                                                                                                                                                                                                                                                                                                                                                                         NCBI.REFSEQ
Stat2                                                                                                                                                                                                                                                                                                                                                                                                                           NM_019963; NP_064347
Gm6472                                                                                                                                                                                                                                                                                                                                                                                                                                            NA
Klhl24                                                                                                                                                                                                                                                                                                                                                                                              NM_029436; NP_083712; XM_006522687; XP_006522750
Mrpl3                                                                                                                                                                                                                                                                                                                                                                   NM_001364512; NM_001364513; NM_053159; NP_001351441; NP_001351442; NP_444389
Ube2l3                                                                                                                                                                                                                                                                                                                                                                                              NM_009456; NP_033482; XM_006522004; XP_006522067
Smchd1                                                                                                                                                                                                                                                                                                                                                                                              NM_028887; NP_083163; XM_030250119; XP_030105979
Rab2b                                                                                                                                                                                                                                                                                                                                                                                               NM_172601; NP_766189; XM_030248092; XP_030103952
Cyc1                                                                                                                                                                                                                                                                                                                                                                                                NM_025567; NP_079843; XM_030248694; XP_030104554
Fam188a NM_001355535; NM_001355536; NM_001355537; NM_001355538; NM_001355539; NM_024185; NP_001342464; NP_001342465; NP_001342466; NP_001342467; NP_001342468; NP_077147; NR_149730; NR_149731; NR_149732; NR_149745; XM_006497522; XM_006497523; XM_006497524; XM_006497525; XM_006497526; XM_006497529; XM_030251974; XP_006497585; XP_006497586; XP_006497587; XP_006497588; XP_006497589; XP_006497592; XP_030107834; XR_001783166; XR_003953695
Aldh9a1                                                                                                                                                                                                                                                                                                                                                                                             NM_019993; NP_064377; XM_006496950; XP_006497013
        NCBI.SYMBOL      logFC   AveExpr         t      P.Value
Stat2         Stat2 -1.4969790  4.864508 -5.618702 0.0001182248
Gm6472     Rps7-ps3  0.2648009 11.459065  5.240865 0.0002163819
Klhl24       Klhl24 -0.6101068  7.363387 -4.759046 0.0004814548
Mrpl3         Mrpl3  0.8492608  5.617527  4.788993 0.0004576821
Ube2l3       Ube2l3  0.4144942  8.044244  4.692104 0.0005393919
Smchd1       Smchd1 -0.9369847  6.151109 -4.643970 0.0005855291
Rab2b         Rab2b -1.4425991  5.222047 -4.412040 0.0008732473
Cyc1           Cyc1  0.6856786  6.011196  4.206570 0.0012513216
Fam188a      Mindy3 -1.3066249  4.389511 -4.518645 0.0007260633
Aldh9a1     Aldh9a1 -0.5586245  6.541156 -4.181715 0.0013074240
        adj.P.Val           B
Stat2   0.7205038  0.58999113
Gm6472  0.7205038  0.20128191
Klhl24  0.7205038  0.18823251
Mrpl3   0.7205038  0.11330417
Ube2l3  0.7205038  0.03681287
Smchd1  0.7205038 -0.05234266
Rab2b   0.7205038 -0.61294850
Cyc1    0.7205038 -0.69862528
Fam188a 0.7205038 -0.70942116
Aldh9a1 0.7205038 -0.72301533</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC  AveExpr        t      P.Value adj.P.Val
Smchd1 -0.9369847 6.151109 -4.64397 0.0005855291 0.7205038
                 B
Smchd1 -0.05234266</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests">Gene set tests</h3>
<ul>
<li>Cant use output of <code>voomLmFit()</code>, so have to re-fit model with <strong>edgeR</strong> or <code>voomWithQualityWeights()</code></li>
<li>Marnie and Sarah interested in chrX as a whole</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_X</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>y_X</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>y</span>, design <span class='op'>=</span> <span class='va'>y_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>y</span>,
  index <span class='op'>=</span> <span class='va'>y_index</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  contrast <span class='op'>=</span> <span class='va'>y_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    698 0.08309456 0.06446991      Down 0.8964 0.8964        0.026
  FDR.Mixed
X     0.026</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_y</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>y_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_y</span>,
  index <span class='op'>=</span> <span class='va'>y_index</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  contrast <span class='op'>=</span> <span class='va'>y_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    698 0.09312321 0.09455587        Up 0.1756 0.1756       0.0367
  FDR.Mixed
X    0.0367</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_status</span><span class='op'>[</span><span class='va'>y_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>y_fit</span>,
  status <span class='op'>=</span> <span class='va'>y_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>y_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>y_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<h1 id="male-only-analysis-of-aggregated-tech-reps">Male-only: analysis of aggregated tech reps</h1>
<h2 id="mds-2">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>ym</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>ym_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ym_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>ym_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-32-1.png" width="624" /></p>
</div>
<h2 id="array-weights-2">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span>, <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>ym</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_aw</span> <span class='op'>&lt;-</span> <span class='va'>ym_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ym_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span>
<span class='va'>ym_aw</span> <span class='op'>&lt;-</span> <span class='va'>ym_aw</span><span class='op'>[</span><span class='va'>ym_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>ym_aw</span>, col <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>ym_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-2">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>ym_design</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>ym_fit</span>, <span class='va'>ym_contrasts</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>ym_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ym_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     17248
Up             0</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>ym_fit</span>, status <span class='op'>=</span> <span class='va'>ym_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                    ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Malat1                          lincRNA           Malat1
Gm6472 transcribed_processed_pseudogene           Gm6472
mt-Nd2                   protein_coding           mt-Nd2
Eif5a                    protein_coding            Eif5a
Cfl1                     protein_coding             Cfl1
Arpc2                    protein_coding            Arpc2
Pbx1                     protein_coding             Pbx1
Ybx1                     protein_coding             Ybx1
Srgn                     protein_coding             Srgn
Actb                     protein_coding             Actb
       ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Malat1              5795690            5802672              19
Gm6472            152909505          152910155               X
mt-Nd2                 3914               4951              MT
Eif5a              69916714           69921958              11
Cfl1                5490485            5494029              19
Arpc2              74236084           74268209               1
Pbx1              168119364          168432270               1
Ybx1              119277981          119294604               4
Srgn               62493833           62527451              10
Actb              142903115          142906754               5
       ENSEMBL.SYMBOL        ENSEMBL.GENEID
Malat1         Malat1  ENSMUSG00000092341.3
Gm6472         Gm6472  ENSMUSG00000095597.2
mt-Nd2         mt-Nd2  ENSMUSG00000064345.1
Eif5a           Eif5a ENSMUSG00000078812.10
Cfl1             Cfl1  ENSMUSG00000056201.8
Arpc2           Arpc2 ENSMUSG00000006304.14
Pbx1             Pbx1 ENSMUSG00000052534.15
Ybx1             Ybx1 ENSMUSG00000028639.14
Srgn             Srgn ENSMUSG00000020077.14
Actb             Actb ENSMUSG00000029580.14
                                                                                              NCBI.ALIAS
Malat1                                        2210401K01Rik; 9430072K23Rik; AI647968; NEA; Neat2; Malat1
Gm6472                                                                        EG624124; Gm6472; Rps7-ps3
mt-Nd2                                                                                               ND2
Eif5a             AA410058; D19Wsu54; D19Wsu54e; Eif4d; Eif5a1; eIF-4D; eIF-5A; eIF-5A-1; eIF-5A1; Eif5a
Cfl1                                                                        AA959946; Cof; co; n-c; Cfl1
Arpc2                                                         2210023N03Rik; 34kDa; p34-; p34-Arc; Arpc2
Pbx1                                                2310056B04Rik; D230003C07Rik; Pbx; Pbx-; Pbx-1; Pbx1
Ybx1   1700102N10; 1700102N10Rik; C79409; EF1; EF1A; MSY; MSY1; Ns; Nsep1; YB-1; dbp; dbpB; mYB-1a; Ybx1
Srgn                                                                        Pr; Prg; Prg1; Sg; Sgc; Srgn
Actb                                                  Act; Actx; E430023M04Rik; beta-a; beta-actin; Actb
       NCBI.ENTREZID
Malat1         72289
Gm6472        624124
mt-Nd2         17717
Eif5a         276770
Cfl1           12631
Arpc2          76709
Pbx1           18514
Ybx1           22608
Srgn           19073
Actb           11461
                                                                 NCBI.GENENAME
Malat1 metastasis associated lung adenocarcinoma transcript 1 (non-coding RNA)
Gm6472                                      ribosomal protein S7, pseudogene 3
mt-Nd2                                            NADH dehydrogenase subunit 2
Eif5a                              eukaryotic translation initiation factor 5A
Cfl1                                                     cofilin 1, non-muscle
Arpc2                             actin related protein 2/3 complex, subunit 2
Pbx1                                            pre B cell leukemia homeobox 1
Ybx1                                                           Y box protein 1
Srgn                                                                 serglycin
Actb                                                               actin, beta
                                                                                                                                                                                                                                                                                                                                    NCBI.REFSEQ
Malat1                                                                                                                                                                                                                                                                                                                                NR_002847
Gm6472                                                                                                                                                                                                                                                                                                                                       NA
mt-Nd2                                                                                                                                                                                                                                                                                                                                NP_904329
Eif5a  NM_001166589; NM_001166590; NM_001166591; NM_001166592; NM_001166593; NM_001166594; NM_001166595; NM_001166596; NM_181582; NP_001160061; NP_001160062; NP_001160063; NP_001160064; NP_001160065; NP_001160066; NP_001160067; NP_001160068; NP_853613; XM_011249058; XM_030246050; XM_030246051; XP_011247360; XP_030101910; XP_030101911
Cfl1                                                                                                                                                                                                                                                                                                                       NM_007687; NP_031713
Arpc2                                                                                                                                                                                                                                                              NM_001357387; NM_029711; NP_001344316; NP_083987; XM_030243491; XP_030099351
Pbx1                                                                                                                                                                                 NM_001291508; NM_001291509; NM_008783; NM_183355; NP_001278437; NP_001278438; NP_032809; NP_899198; XM_006496699; XM_006496700; XP_006496762; XP_006496763
Ybx1                                                                                                                                                                                                                                   NM_011732; NP_035862; XM_006502933; XM_006502934; XM_030253407; XP_006502996; XP_006502997; XP_030109267
Srgn                                                                                                                                               NM_001358965; NM_011157; NP_001345894; NP_035287; XM_006513374; XM_006513376; XM_006513377; XM_030244953; XM_030244954; XP_006513437; XP_006513439; XP_006513440; XP_030100813; XP_030100814
Actb                                                                                                                                                                                                                                                                                           NM_007393; NP_031419; XM_030254057; XP_030109917
       NCBI.SYMBOL      logFC  AveExpr         t     P.Value
Malat1      Malat1 -0.3625330 13.03605 -3.678660 0.007647652
Gm6472    Rps7-ps3  0.1987320 11.45263  3.167250 0.015428056
mt-Nd2         ND2  0.4610753 11.31535  2.862019 0.023841982
Eif5a        Eif5a  0.2934623 10.74414  3.035906 0.018580601
Cfl1          Cfl1  0.3181711 10.46614  3.218544 0.014356073
Arpc2        Arpc2  0.2934949 10.04898  3.508253 0.009622813
Pbx1          Pbx1 -0.2978513 10.60830 -2.771241 0.027191956
Ybx1          Ybx1  0.3641578 10.26075  2.522674 0.039125930
Srgn          Srgn  0.2048134 11.73539  2.164260 0.066551604
Actb          Actb  0.1095270 12.14783  2.146474 0.068334906
       adj.P.Val         B
Malat1 0.9969908 -2.165410
Gm6472 0.9969908 -3.073269
mt-Nd2 0.9969908 -3.311990
Eif5a  0.9969908 -3.407302
Cfl1   0.9969908 -3.419845
Arpc2  0.9969908 -3.475936
Pbx1   0.9969908 -3.684457
Ybx1   0.9969908 -3.841695
Srgn   0.9969908 -3.857312
Actb   0.9969908 -3.868261</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC  AveExpr         t   P.Value adj.P.Val         B
Smchd1 -0.5245546 6.187839 -1.739218 0.1248504 0.9969908 -4.541153</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-39-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests-1">Gene set tests</h3>
<p><strong>TODO</strong>: Large discrepancy between *edgeR** and <code>voomWithQualityWeights()</code> results</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_X</span> <span class='op'>&lt;-</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>ym_X</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>ym</span>, design <span class='op'>=</span> <span class='va'>ym_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>ym</span>,
  index <span class='op'>=</span> <span class='va'>ym_index</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  contrast <span class='op'>=</span> <span class='va'>ym_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    635 0.08503937 0.07244094      Down 0.0154 0.0154       0.0295
  FDR.Mixed
X    0.0295</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_ym</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>ym</span>, <span class='va'>ym_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_ym</span>,
  index <span class='op'>=</span> <span class='va'>ym_index</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  contrast <span class='op'>=</span> <span class='va'>ym_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    635 0.07401575 0.08818898      Down 0.9275 0.9275       0.3547
  FDR.Mixed
X    0.3547</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_status</span><span class='op'>[</span><span class='va'>ym_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>ym_fit</span>,
  status <span class='op'>=</span> <span class='va'>ym_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>ym_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>ym_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-43-1.png" width="624" /></p>
</div>
<h1 id="female-only-analysis-of-aggregated-tech-reps">Female-only: analysis of aggregated tech reps</h1>
<h2 id="mds-3">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>yf</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>yf_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>yf_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>yf_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-44-1.png" width="624" /></p>
</div>
<h2 id="array-weights-3">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span>, <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='co'># NOTE: Drop WT column as there are no female WT samples.</span>
<span class='va'>yf_design</span> <span class='op'>&lt;-</span> <span class='va'>yf_design</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>yf</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-45-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_aw</span> <span class='op'>&lt;-</span> <span class='va'>yf_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>yf_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span>
<span class='va'>yf_aw</span> <span class='op'>&lt;-</span> <span class='va'>yf_aw</span><span class='op'>[</span><span class='va'>yf_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>yf_aw</span>, col <span class='op'>=</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>yf_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-46-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-3">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>yf_design</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>yf_fit</span>, <span class='va'>yf_contrasts</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>yf_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-47-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>yf_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     14609
Up             0</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>yf_fit</span>, status <span class='op'>=</span> <span class='va'>yf_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-48-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Gm10925             unprocessed_pseudogene          Gm10925
mt-Nd4                      protein_coding           mt-Nd4
Rps4x                       protein_coding            Rps4x
mt-Nd1                      protein_coding           mt-Nd1
Rpl31-ps8             processed_pseudogene        Rpl31-ps8
Gm6472    transcribed_processed_pseudogene           Gm6472
mt-Cytb                     protein_coding          mt-Cytb
Gm28437             unprocessed_pseudogene          Gm28437
Gm15500   transcribed_processed_pseudogene          Gm15500
Rps10-ps2             processed_pseudogene        Rps10-ps2
          ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Gm10925               24613974           24614651               1
mt-Nd4                   10167              11544              MT
Rps4x                102184941          102189394               X
mt-Nd1                    2751               3707              MT
Rpl31-ps8             90764279           90764656              15
Gm6472               152909505          152910155               X
mt-Cytb                  14145              15288              MT
Gm28437               24613189           24613971               1
Gm15500              114705217          114706235               7
Rps10-ps2             20822145           20822640              16
          ENSEMBL.SYMBOL       ENSEMBL.GENEID
Gm10925          Gm10925 ENSMUSG00000100862.1
mt-Nd4            mt-Nd4 ENSMUSG00000064363.1
Rps4x              Rps4x ENSMUSG00000031320.9
mt-Nd1            mt-Nd1 ENSMUSG00000064341.1
Rpl31-ps8      Rpl31-ps8 ENSMUSG00000067870.5
Gm6472            Gm6472 ENSMUSG00000095597.2
mt-Cytb          mt-Cytb ENSMUSG00000064370.1
Gm28437          Gm28437 ENSMUSG00000101111.1
Gm15500          Gm15500 ENSMUSG00000086583.3
Rps10-ps2      Rps10-ps2 ENSMUSG00000099764.1
                                       NCBI.ALIAS NCBI.ENTREZID
Gm10925   Atp6; Atpase6; Mtatp6; mt-Atp6; Gm10925     100503946
mt-Nd4                                        ND4         17719
Rps4x                 R; Rps; Rps4; Rps4-1; Rps4x         20102
mt-Nd1                                        ND1         17716
Rpl31-ps8                                      NA            NA
Gm6472                 EG624124; Gm6472; Rps7-ps3        624124
mt-Cytb                                      CYTB         17711
Gm28437                                        NA            NA
Gm15500                                   Gm15500     100043295
Rps10-ps2             EG666274; Gm8017; Rps10-ps2        666274
                                 NCBI.GENENAME
Gm10925   ATP synthase F0 subunit 6 pseudogene
mt-Nd4            NADH dehydrogenase subunit 4
Rps4x           ribosomal protein S4, X-linked
mt-Nd1            NADH dehydrogenase subunit 1
Rpl31-ps8                                   NA
Gm6472      ribosomal protein S7, pseudogene 3
mt-Cytb                           cytochrome b
Gm28437                                     NA
Gm15500        ribosomal protein L5 pseudogene
Rps10-ps2  ribosomal protein S10, pseudogene 2
                                               NCBI.REFSEQ
Gm10925                                                 NA
mt-Nd4                                           NP_904337
Rps4x     NM_009094; NP_033120; XM_011247553; XP_011245855
mt-Nd1                                           NP_904328
Rpl31-ps8                                               NA
Gm6472                                                  NA
mt-Cytb                                          NP_904340
Gm28437                                                 NA
Gm15500                                                 NA
Rps10-ps2                                     NM_001111278
          NCBI.SYMBOL     logFC  AveExpr        t      P.Value
Gm10925       Gm10925 0.4761805 13.59659 5.236073 0.0009528682
mt-Nd4            ND4 0.3920449 12.43904 5.831377 0.0004890598
Rps4x           Rps4x 0.4255952 11.65107 5.420479 0.0007711156
mt-Nd1            ND1 0.3517964 11.90047 4.200491 0.0034206841
Rpl31-ps8          NA 0.3777331 10.95915 4.787495 0.0016262554
Gm6472       Rps7-ps3 0.3122722 11.46928 3.852048 0.0054488539
mt-Cytb          CYTB 0.2181543 13.68329 3.145592 0.0147711274
Gm28437            NA 0.3823127 11.81898 3.356110 0.0108963990
Gm15500       Gm15500 0.2139272 11.89695 3.320293 0.0114706930
Rps10-ps2   Rps10-ps2 0.3352373 10.34848 3.893695 0.0051490554
          adj.P.Val          B
Gm10925   0.8445392 -0.8057953
mt-Nd4    0.8445392 -1.1716973
Rps4x     0.8445392 -1.8607470
mt-Nd1    0.8445392 -2.3055051
Rpl31-ps8 0.8445392 -2.4851288
Gm6472    0.8445392 -2.6890810
mt-Cytb   0.8445392 -2.7166532
Gm28437   0.8445392 -2.8921971
Gm15500   0.8445392 -2.8979000
Rps10-ps2 0.8445392 -3.0937417</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
           logFC  AveExpr         t     P.Value adj.P.Val         B
Smchd1 -1.146664 6.118155 -4.351497 0.002811413 0.8445392 -4.218821</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-51-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests-2">Gene set tests</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_X</span> <span class='op'>&lt;-</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>yf_X</span><span class='op'>)</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>yf</span>, design <span class='op'>=</span> <span class='va'>yf_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>yf</span>,
  index <span class='op'>=</span> <span class='va'>yf_index</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  contrast <span class='op'>=</span> <span class='va'>yf_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    544 0.07536765 0.1011029        Up 0.0691 0.0691       0.0422
  FDR.Mixed
X    0.0422</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_yf</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>yf</span>, <span class='va'>yf_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_yf</span>,
  index <span class='op'>=</span> <span class='va'>yf_index</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  contrast <span class='op'>=</span> <span class='va'>yf_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    544  0.09375 0.1231618        Up 0.0458 0.0458       0.0464
  FDR.Mixed
X    0.0464</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_status</span><span class='op'>[</span><span class='va'>yf_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>yf_fit</span>,
  status <span class='op'>=</span> <span class='va'>yf_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>yf_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>yf_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons_files/figure-html5/unnamed-chunk-55-1.png" width="624" /></p>
</div>
<h1 id="todos">TODOs</h1>
<ul>
<li><input type="checkbox" disabled="" />
Exclude pseudogenes and all that crap?</li>
<li><input type="checkbox" disabled="" />
Compare gene lists from analysis of <code>x</code> and <code>y</code></li>
<li><input type="checkbox" disabled="" />
Include <code>sex</code> in design matrix for analysis of <code>x</code> and <code>y</code>?</li>
</ul>
<h1 id="session-info" class="appendix">Session info</h1>
<summary>The analysis and this document were prepared using the following software (click triangle to expand)</summary>
<details>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sessioninfo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sessioninfo/man/session_info.html'>session_info</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> Session info 
 setting  value                       
 version  R version 4.0.3 (2020-10-10)
 os       CentOS Linux 7 (Core)       
 system   x86_64, linux-gnu           
 ui       X11                         
 language (EN)                        
 collate  en_US.UTF-8                 
 ctype    en_US.UTF-8                 
 tz       Australia/Melbourne         
 date     2021-03-27                  

 Packages 
 ! package              * version  date       lib source        
 P assertthat             0.2.1    2019-03-21 [?] CRAN (R 4.0.0)
 P Biobase              * 2.50.0   2020-10-27 [?] Bioconductor  
 P BiocGenerics         * 0.36.0   2020-10-27 [?] Bioconductor  
 P bitops                 1.0-6    2013-08-17 [?] CRAN (R 4.0.0)
 P cli                    2.3.1    2021-02-23 [?] CRAN (R 4.0.3)
 P colorspace             2.0-0    2020-11-11 [?] CRAN (R 4.0.3)
 P cowplot              * 1.1.1    2020-12-30 [?] CRAN (R 4.0.3)
 P crayon                 1.4.1    2021-02-08 [?] CRAN (R 4.0.3)
 P DBI                    1.1.1    2021-01-15 [?] CRAN (R 4.0.3)
 P DelayedArray           0.16.1   2021-01-22 [?] Bioconductor  
 P digest                 0.6.27   2020-10-24 [?] CRAN (R 4.0.2)
 P distill                1.2      2021-01-13 [?] CRAN (R 4.0.3)
 P downlit                0.2.1    2020-11-04 [?] CRAN (R 4.0.3)
 P dplyr                  1.0.4    2021-02-02 [?] CRAN (R 4.0.3)
 P edgeR                * 3.32.1   2021-01-14 [?] Bioconductor  
 P ellipsis               0.3.1    2020-05-15 [?] CRAN (R 4.0.0)
 P evaluate               0.14     2019-05-28 [?] CRAN (R 4.0.0)
 P fansi                  0.4.2    2021-01-15 [?] CRAN (R 4.0.3)
 P farver                 2.0.3    2020-01-16 [?] CRAN (R 4.0.0)
 P generics               0.1.0    2020-10-31 [?] CRAN (R 4.0.3)
 P GenomeInfoDb         * 1.26.2   2020-12-08 [?] Bioconductor  
 P GenomeInfoDbData       1.2.4    2020-10-20 [?] Bioconductor  
 P GenomicRanges        * 1.42.0   2020-10-27 [?] Bioconductor  
 P ggplot2              * 3.3.3    2020-12-30 [?] CRAN (R 4.0.3)
 P ggrepel              * 0.9.1    2021-01-15 [?] CRAN (R 4.0.3)
 P glue                   1.4.2    2020-08-27 [?] CRAN (R 4.0.0)
 P gtable                 0.3.0    2019-03-25 [?] CRAN (R 4.0.0)
 P here                 * 1.0.1    2020-12-13 [?] CRAN (R 4.0.3)
 P highr                  0.8      2019-03-20 [?] CRAN (R 4.0.0)
 P htmltools              0.5.1.1  2021-01-22 [?] CRAN (R 4.0.3)
 P IRanges              * 2.24.1   2020-12-12 [?] Bioconductor  
 P knitr                  1.31     2021-01-27 [?] CRAN (R 4.0.3)
 P labeling               0.4.2    2020-10-20 [?] CRAN (R 4.0.0)
 P lattice                0.20-41  2020-04-02 [3] CRAN (R 4.0.3)
 P lifecycle              1.0.0    2021-02-15 [?] CRAN (R 4.0.3)
 P limma                * 3.46.0   2020-10-27 [?] Bioconductor  
 P locfit                 1.5-9.4  2020-03-25 [?] CRAN (R 4.0.0)
 P magrittr               2.0.1    2020-11-17 [?] CRAN (R 4.0.3)
 P Matrix                 1.2-18   2019-11-27 [3] CRAN (R 4.0.3)
 P MatrixGenerics       * 1.2.1    2021-01-30 [?] Bioconductor  
 P matrixStats          * 0.58.0   2021-01-29 [?] CRAN (R 4.0.3)
 P munsell                0.5.0    2018-06-12 [?] CRAN (R 4.0.0)
 P patchwork            * 1.1.1    2020-12-17 [?] CRAN (R 4.0.3)
 P pillar                 1.5.0    2021-02-22 [?] CRAN (R 4.0.3)
 P pkgconfig              2.0.3    2019-09-22 [?] CRAN (R 4.0.0)
 P purrr                  0.3.4    2020-04-17 [?] CRAN (R 4.0.0)
 P R6                     2.5.0    2020-10-28 [?] CRAN (R 4.0.2)
 P Rcpp                   1.0.6    2021-01-15 [?] CRAN (R 4.0.3)
 P RCurl                  1.98-1.2 2020-04-18 [?] CRAN (R 4.0.0)
 P rlang                  0.4.10   2020-12-30 [?] CRAN (R 4.0.3)
 P rmarkdown              2.7      2021-02-19 [?] CRAN (R 4.0.3)
 P rprojroot              2.0.2    2020-11-15 [?] CRAN (R 4.0.3)
 P S4Vectors            * 0.28.1   2020-12-09 [?] Bioconductor  
 P scales                 1.1.1    2020-05-11 [?] CRAN (R 4.0.0)
 P sessioninfo            1.1.1    2018-11-05 [?] CRAN (R 4.0.0)
 P SingleCellExperiment * 1.12.0   2020-10-27 [?] Bioconductor  
 P statmod                1.4.35   2020-10-19 [?] CRAN (R 4.0.2)
 P stringi                1.5.3    2020-09-09 [?] CRAN (R 4.0.0)
 P stringr                1.4.0    2019-02-10 [?] CRAN (R 4.0.0)
 P SummarizedExperiment * 1.20.0   2020-10-27 [?] Bioconductor  
 P tibble                 3.0.6    2021-01-29 [?] CRAN (R 4.0.3)
 P tidyselect             1.1.0    2020-05-11 [?] CRAN (R 4.0.0)
 P utf8                   1.1.4    2018-05-24 [?] CRAN (R 4.0.0)
 P vctrs                  0.3.6    2020-12-17 [?] CRAN (R 4.0.3)
 P viridisLite            0.3.0    2018-02-01 [?] CRAN (R 4.0.0)
 P withr                  2.4.1    2021-01-26 [?] CRAN (R 4.0.3)
 P xfun                   0.21     2021-02-10 [?] CRAN (R 4.0.3)
 P XVector                0.30.0   2020-10-27 [?] Bioconductor  
 P yaml                   2.2.1    2020-02-01 [?] CRAN (R 4.0.0)
 P zlibbioc               1.36.0   2020-10-27 [?] Bioconductor  

[1] /stornext/Projects/score/Analyses/C086_Kinkel/renv/library/R-4.0/x86_64-pc-linux-gnu
[2] /tmp/Rtmpdu75iZ/renv-system-library
[3] /stornext/System/data/apps/R/R-4.0.3/lib64/R/library

 P  Loaded and on-disk path mismatch.</code></pre>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Old stuff below here</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/knit_exit.html'>knit_exit</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
