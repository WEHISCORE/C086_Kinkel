<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set</title>
  
  <meta property="description" itemprop="description" content="UMI-based analysis"/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-03-31"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-03-31"/>
  <meta name="article:author" content="Peter Hickey"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="UMI-based analysis"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="C086"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="C086: Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"/>
  <meta property="twitter:description" content="UMI-based analysis"/>
  
  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","editor_options","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set"]},{"type":"character","attributes":{},"value":["UMI-based analysis"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Peter Hickey"]},{"type":"character","attributes":{},"value":["https://peterhickey.org"]},{"type":"character","attributes":{},"value":["WEHI SCORE"]},{"type":"character","attributes":{},"value":["https://www.wehi.edu.au/people/shalin-naik/3310/score"]}]}]},{"type":"character","attributes":{},"value":["2021-03-31"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"character","attributes":{},"value":["ref.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>
  
  <script type="application/javascript">
  
    window.headroom_prevent_pin = false;
  
    window.document.addEventListener("DOMContentLoaded", function (event) {
  
      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');
  
      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });
  
      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });
  
      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>
  
  <style type="text/css">
  
  /* Theme (user-documented overrideables for nav appearance) */
  
  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }
  
  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }
  
  .distill-site-nav a:hover {
    color: white;
  }
  
  @media print {
    .distill-site-nav {
      display: none;
    }
  }
  
  .distill-site-header {
  
  }
  
  .distill-site-footer {
  
  }
  
  
  /* Site Header */
  
  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }
  
  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }
  
  
  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }
  
  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }
  
  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }
  
  .distill-site-header .logo {
    padding: 0;
  }
  
  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }
  
  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }
  
  
  
  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }
  
  
  .distill-site-header .nav-toggle {
    display: none;
  }
  
  .nav-dropdown {
    display: inline-block;
    position: relative;
  }
  
  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }
  
  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }
  
  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .nav-dropdown-active {
    display: block;
  }
  
  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }
  
  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }
  
  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }
  
  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }
  
  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }
  
  /* Site Footer */
  
  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }
  
  /* Headroom */
  
  d-title {
    padding-top: 6rem;
  }
  
  @media print {
    d-title {
      padding-top: 4rem;
    }
  }
  
  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }
  
  .headroom--transition {
    transition: all .4s ease-in-out;
  }
  
  .headroom--unpinned {
    top: -100px;
  }
  
  .headroom--pinned {
    top: 0;
  }
  
  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }
  
  </style>
  
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>
  
  <script type="application/javascript">
  
  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }
  
  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }
  
  function createFuseIndex() {
  
    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);
  
    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });
  
        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }
  
  window.document.addEventListener("DOMContentLoaded", function (event) {
  
    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;
  
    createFuseIndex()
      .then(function(fuse) {
  
        // make search box visible
        searchEl.classList.remove('hidden');
  
        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });
  
  });
  
  </script>
  
  <style type="text/css">
  
  .nav-search {
    font-size: x-small;
  }
  
  /* Algolioa Autocomplete */
  
  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }
  
  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }
  
  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }
  
  </style>
  
  
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set","description":"UMI-based analysis","authors":[{"author":"Peter Hickey","authorURL":"https://peterhickey.org","affiliation":"WEHI SCORE","affiliationURL":"https://www.wehi.edu.au/people/shalin-naik/3310/score","orcidID":""}],"publishedDate":"2021-03-31T00:00:00.000+11:00","citationText":"Hickey, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">C086</a>
<a href="index.html">Introduction</a>
<a href="C086_Kinkel.preprocess.html">Preprocessing</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Differential analyses
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="C086_Kinkel.multi-sample_comparisons.reads.html">Read-based</a>
<a href="C086_Kinkel.multi-sample_comparisons.UMIs.html">UMI-based</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Supplementary files
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../output/scPipe/">scPipe reports</a>
<a href="../output/DEGs/">Differentially expressed genes</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="https://github.com/WEHISCORE/C086_Kinkel">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Multi-sample comparisons of the Kinkel (C086) Smchd1 LSK mini-bulk data set</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>UMI-based analysis</p>
</div>

<div class="d-byline">
  Peter Hickey <a href="https://peterhickey.org" class="uri">https://peterhickey.org</a> (WEHI SCORE)<a href="https://www.wehi.edu.au/people/shalin-naik/3310/score" class="uri">https://www.wehi.edu.au/people/shalin-naik/3310/score</a>
  
<br/>2021-03-31
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#setup">Setup</a><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#load-data">Load data</a></li>
<li><a href="#create-dgelist-objects">Create DGEList objects</a></li>
<li><a href="#gene-filtering">Gene filtering</a></li>
<li><a href="#normalization">Normalization</a></li>
</ul></li>
<li><a href="#analysis-of-individuals-tech-reps">Analysis of individuals tech reps</a><ul>
<li><a href="#mds">MDS</a><ul>
<li><a href="#after-excluding-outliers">After excluding outliers</a></li>
</ul></li>
<li><a href="#array-weights">Array weights</a></li>
<li><a href="#de-analysis">DE analysis</a></li>
</ul></li>
<li><a href="#analysis-of-aggregated-tech-reps">Analysis of aggregated tech reps</a><ul>
<li><a href="#mds-1">MDS</a></li>
<li><a href="#array-weights-1">Array weights</a><ul>
<li><a href="#comparison-to-individual-tech-reps">Comparison to individual tech reps</a></li>
</ul></li>
<li><a href="#de-analysis-1">DE analysis</a><ul>
<li><a href="#gene-set-tests">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#male-only-analysis-of-aggregated-tech-reps">Male-only: analysis of aggregated tech reps</a><ul>
<li><a href="#mds-2">MDS</a></li>
<li><a href="#array-weights-2">Array weights</a></li>
<li><a href="#de-analysis-2">DE analysis</a><ul>
<li><a href="#gene-set-tests-1">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#female-only-analysis-of-aggregated-tech-reps">Female-only: analysis of aggregated tech reps</a><ul>
<li><a href="#mds-3">MDS</a></li>
<li><a href="#array-weights-3">Array weights</a></li>
<li><a href="#de-analysis-3">DE analysis</a><ul>
<li><a href="#gene-set-tests-2">Gene set tests</a></li>
</ul></li>
</ul></li>
<li><a href="#todos">TODOs</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</nav>
</div>
<h1 id="setup">Setup</h1>
<h2 id="summary">Summary</h2>
<ul>
<li>UMI counts analysed</li>
<li>Various analyses denoted by a prefix (<code>x</code>, <code>y</code>, <code>ym</code>, <code>yf</code>)
<ul>
<li><code>x</code>: <code>voomLmFit()</code> of individual technical replicates, blocking on mouse</li>
<li><code>y</code>: <code>voomLmFit()</code> of aggregated technical reps</li>
<li><code>ym</code>: As with <code>y</code> but <strong>males</strong> only</li>
<li><code>yf</code>: As with <code>y</code> but <strong>females</strong> only</li>
</ul></li>
</ul>
<h2 id="load-data">Load data</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SingleCellExperiment</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://bioinf.wehi.edu.au/edgeR'>edgeR</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/source.html'>source</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"code/helper_functions.R"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>sce</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"SCEs"</span>, <span class='st'>"C086_Kinkel.preprocessed.SCE.rds"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Some useful colours</span>
<span class='va'>sex_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>sex_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>sex_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>smchd1_genotype_updated_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mouse_number_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>mouse_number_colours</span><span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>mouse_number_colours</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="create-dgelist-objects">Create DGEList objects</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></span><span class='op'>(</span>
  counts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>sce</span>, <span class='st'>"UMI_counts"</span><span class='op'>)</span><span class='op'>)</span>,
  samples <span class='op'>=</span> <span class='fu'>colData</span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>,
  group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated</span><span class='op'>)</span>,
  genes <span class='op'>=</span> <span class='fu'>flattenDF</span><span class='op'>(</span><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>!</span><span class='fu'>matrixStats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/matrixStats/man/rowAlls.html'>rowAlls</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>counts</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/sumTechReps.html'>sumTechReps</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>genotype.mouse</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sex</span> <span class='op'>==</span> <span class='st'>"M"</span><span class='op'>]</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sex</span> <span class='op'>==</span> <span class='st'>"F"</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h2 id="gene-filtering">Gene filtering</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>x</span>, group <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>x_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>x_keep_exprs
FALSE  TRUE 
17481  8105 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>x_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>y</span>, group <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>y_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>y_keep_exprs
FALSE  TRUE 
12971 12615 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='va'>y_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>ym</span>, group <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>ym_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>ym_keep_exprs
FALSE  TRUE 
14016 11570 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='va'>ym</span><span class='op'>[</span><span class='va'>ym_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_keep_exprs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>yf</span>, group <span class='op'>=</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>yf_keep_exprs</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>yf_keep_exprs
FALSE  TRUE 
14726 10860 </code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='va'>yf</span><span class='op'>[</span><span class='va'>yf_keep_exprs</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h2 id="normalization">Normalization</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>ym</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></span><span class='op'>(</span><span class='va'>yf</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="analysis-of-individuals-tech-reps">Analysis of individuals tech reps</h1>
<h2 id="mds">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>x</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>x_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>x_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<h3 id="after-excluding-outliers">After excluding outliers</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>outliers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Del.1282.2"</span>, <span class='st'>"Het.1248.2"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<ul>
<li>Exclude Del.1282.2, Het.1248.2</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='va'>outliers</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>x2_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>x2</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>x2_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x2_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>x2_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>x2</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x2</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x2_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>x2_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h2 id="array-weights">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span> <span class='op'>+</span> <span class='va'>sex</span>, <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x_design</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  design <span class='op'>=</span> <span class='va'>x_design</span>,
  block <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>mouse_number</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<ul>
<li><strong>TODO</strong>: How to interpret small intra-block correlation (<code>x_fit$cor</code> = 0.0638158)?</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_aw</span> <span class='op'>&lt;-</span> <span class='va'>x_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>x_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>x_aw</span> <span class='op'>&lt;-</span> <span class='va'>x_aw</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span>
  <span class='va'>x_aw</span>,
  col <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>,
  las <span class='op'>=</span> <span class='fl'>2</span>,
  cex.names <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<h2 id="de-analysis">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>x_design</span><span class='op'>)</span>
<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>x_fit</span>, <span class='va'>x_contrasts</span><span class='op'>)</span>
<span class='va'>x_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>x_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>x_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           1
NotSig      8103
Up             1</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>x_fit</span>, status <span class='op'>=</span> <span class='va'>x_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, main <span class='op'>=</span> <span class='st'>"Del - Het"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>              ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Smchd1             protein_coding           Smchd1
Itsn1              protein_coding            Itsn1
Mxd4               protein_coding             Mxd4
Tomm5              protein_coding            Tomm5
C130026I21Rik      protein_coding    C130026I21Rik
Plac8              protein_coding            Plac8
Sugp2              protein_coding            Sugp2
Cep350             protein_coding           Cep350
Mid1               protein_coding             Mid1
Ubfd1              protein_coding            Ubfd1
              ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Smchd1                    71344489           71475343              17
Itsn1                     91729281           91920597              16
Mxd4                      34173887           34187720               5
Tomm5                     45105208           45108114               4
C130026I21Rik             84992690           85270566               1
Plac8                    100553725          100572245               5
Sugp2                     70234226           70279915               8
Cep350                   155844964          155973255               1
Mid1                     169685199          170005736               X
Ubfd1                    122067175          122082194               7
              ENSEMBL.SYMBOL        ENSEMBL.GENEID
Smchd1                Smchd1 ENSMUSG00000024054.14
Itsn1                  Itsn1 ENSMUSG00000022957.20
Mxd4                    Mxd4 ENSMUSG00000037235.13
Tomm5                  Tomm5  ENSMUSG00000078713.8
C130026I21Rik  C130026I21Rik ENSMUSG00000052477.15
Plac8                  Plac8 ENSMUSG00000029322.12
Sugp2                  Sugp2 ENSMUSG00000036054.15
Cep350                Cep350 ENSMUSG00000033671.18
Mid1                    Mid1 ENSMUSG00000035299.16
Ubfd1                  Ubfd1 ENSMUSG00000030870.12
                                                                                                       NCBI.ALIAS
Smchd1                                                4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
Itsn1         AA517634; AA545208; AI316805; AI839402; AI848451; EHSH; Ehsh1; Ese; Ese1; Itsn; Sh3p; Sh3p17; Itsn1
Mxd4                                                              2810410A03Rik; Mad; Mad4; bHLHc1; bHLHc12; Mxd4
Tomm5                                                                                  1110019J04Rik; Tom5; Tomm5
C130026I21Rik                                                                        4930565N07Rik; C130026I21Rik
Plac8                                                                          C15; D5Wsu111; D5Wsu111e; o; Plac8
Sugp2                                                                  Sfr; Sfrs14; Srs; Srsf14; mKIAA0365; Sugp2
Cep350                                                                       4933409L06Rik; 6430546F08Rik; Cep350
Mid1                                                  61B3-; 61B3-R; DXHXS114; DXHXS1141; Fxy; Trim; Trim18; Mid1
Ubfd1                                             AI467302; D7Wsu105; D7Wsu105e; D7Wsu128; D7Wsu128e; Ubph; Ubfd1
              NCBI.ENTREZID
Smchd1                74355
Itsn1                 16443
Mxd4                  17122
Tomm5                 68512
C130026I21Rik        620078
Plac8                231507
Sugp2                234373
Cep350                74081
Mid1                  17318
Ubfd1                 28018
                                              NCBI.GENENAME
Smchd1                        SMC hinge domain containing 1
Itsn1                 intersectin 1 (SH3 domain protein 1A)
Mxd4                             Max dimerization protein 4
Tomm5         translocase of outer mitochondrial membrane 5
C130026I21Rik                    RIKEN cDNA C130026I21 gene
Plac8                                   placenta-specific 8
Sugp2                  SURP and G patch domain containing 2
Cep350                              centrosomal protein 350
Mid1                                              midline 1
Ubfd1                  ubiquitin family domain containing 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     NCBI.REFSEQ
Smchd1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NM_028887; NP_083163; XM_030250119; XP_030105979
Itsn1                                                                                                                                                             NM_001110275; NM_001110276; NM_010587; NP_001103745; NP_001103746; NP_034717; XM_006522931; XM_006522932; XM_006522933; XM_006522934; XM_006522935; XM_006522936; XM_006522937; XM_006522938; XM_006522939; XM_006522940; XM_011246102; XP_006522994; XP_006522995; XP_006522996; XP_006522997; XP_006522998; XP_006522999; XP_006523000; XP_006523001; XP_006523002; XP_006523003; XP_011244404; XR_001781793
Mxd4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        NM_010753; NP_034883
Tomm5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     NM_001099675; NM_001134646; NP_001093145; NP_001128118
C130026I21Rik                                                                                                                                                                   NM_001037909; NM_175219; NP_001032998; NP_780428; XM_006496512; XM_006496519; XM_017321879; XM_017321880; XM_017321881; XM_017321882; XM_017321884; XM_017321885; XM_030255713; XM_030255714; XM_030255715; XM_030255716; XP_006496575; XP_006496582; XP_017177368; XP_017177369; XP_017177370; XP_017177371; XP_017177373; XP_017177374; XP_030111573; XP_030111574; XP_030111575; XP_030111576
Plac8                                                                                                                                                                                                                                                                                                                                                                               NM_001370754; NM_139198; NP_001357683; NP_631937; XM_017320849; XM_017320850; XM_030254402; XM_030254403; XM_030254404; XP_017176338; XP_017176339; XP_030110262; XP_030110263; XP_030110264
Sugp2                                                                                                                                                                                                                                                                                                 NM_001168290; NM_172755; NP_001161762; NP_766343; NR_165051; NR_165052; XM_006509644; XM_006509645; XM_006509647; XM_006509648; XM_006509650; XM_011242297; XM_030243480; XP_006509707; XP_006509708; XP_006509710; XP_006509711; XP_006509713; XP_011240599; XP_030099340
Cep350                                                                                                                                                                                                                                                                                    NM_001039184; NP_001034273; XM_006529900; XM_006529902; XM_006529903; XM_006529904; XM_006529905; XM_006529906; XM_006529907; XM_030243199; XM_030243200; XP_006529963; XP_006529965; XP_006529966; XP_006529967; XP_006529968; XP_006529969; XP_006529970; XP_030099059; XP_030099060
Mid1          NM_001290504; NM_001290505; NM_001290506; NM_001290512; NM_010797; NM_183151; NP_001277433; NP_001277434; NP_001277435; NP_001277441; NP_034927; XM_006528736; XM_006528737; XM_006528739; XM_011247789; XM_017318408; XM_017318409; XM_017318410; XM_017318411; XM_017318412; XM_017318413; XM_030251241; XM_030251242; XM_030251243; XM_030251244; XP_006528799; XP_006528800; XP_006528802; XP_011246091; XP_017173897; XP_017173898; XP_017173899; XP_017173900; XP_017173901; XP_017173902; XP_030107101; XP_030107102; XP_030107103; XP_030107104; XR_878259
Ubfd1                                                                                                                                                                                                                                                                                                                                                                                                                                                                   NM_138589; NP_613055; XM_006507913; XM_006507914; XM_006507915; XP_006507976; XP_006507977; XP_006507978
                NCBI.SYMBOL      logFC  AveExpr         t
Smchd1               Smchd1 -0.7337803 6.372870 -4.735030
Itsn1                 Itsn1 -0.4519227 7.234326 -4.136542
Mxd4                   Mxd4 -0.5342023 6.447034 -4.118836
Tomm5                 Tomm5  0.5397867 6.112978  4.138645
C130026I21Rik C130026I21Rik  1.4856437 4.333562  4.801627
Plac8                 Plac8  0.7010089 5.374301  4.048282
Sugp2                 Sugp2 -0.5418933 6.511801 -3.927633
Cep350               Cep350 -0.5274760 6.166499 -3.848508
Mid1                   Mid1  0.7736309 5.854082  3.753486
Ubfd1                 Ubfd1 -0.4938718 6.124720 -3.660584
                   P.Value  adj.P.Val           B
Smchd1        1.150308e-05 0.04661622  2.63794840
Itsn1         9.898198e-05 0.17062789  1.15854199
Mxd4          1.052609e-04 0.17062789  0.98521752
Tomm5         9.826057e-05 0.17062789  0.96176189
C130026I21Rik 8.980444e-06 0.04661622  0.55833966
Plac8         1.343137e-04 0.18143542  0.46103841
Sugp2         2.027289e-04 0.23473109  0.44783866
Cep350        2.646100e-04 0.26808303  0.13331035
Mid1          3.629510e-04 0.32685753 -0.03043161
Ubfd1         4.922528e-04 0.38205876 -0.39218219</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC AveExpr        t      P.Value  adj.P.Val        B
Smchd1 -0.7337803 6.37287 -4.73503 1.150308e-05 0.04661622 2.637948</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>x_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, 
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<h1 id="analysis-of-aggregated-tech-reps">Analysis of aggregated tech reps</h1>
<h2 id="mds-1">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>y</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>y_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>y_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>y_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<h2 id="array-weights-1">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span> <span class='op'>+</span> <span class='va'>sex</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>y</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_aw</span> <span class='op'>&lt;-</span> <span class='va'>y_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>y_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>
<span class='va'>y_aw</span> <span class='op'>&lt;-</span> <span class='va'>y_aw</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>y_aw</span>, col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<h3 id="comparison-to-individual-tech-reps">Comparison to individual tech reps</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span>
  <span class='va'>x_aw</span>,
  col <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>x_o</span><span class='op'>]</span>,
  las <span class='op'>=</span> <span class='fl'>2</span>,
  cex.names <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>y_aw</span>, col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>y_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-1">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>y_design</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>y_fit</span>, <span class='va'>y_contrasts</span><span class='op'>)</span>
<span class='va'>y_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>y_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>y_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     12615
Up             0</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>y_fit</span>, status <span class='op'>=</span> <span class='va'>y_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>              ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Smchd1             protein_coding           Smchd1
C130026I21Rik      protein_coding    C130026I21Rik
Pbxip1             protein_coding           Pbxip1
Mxd4               protein_coding             Mxd4
Tomm5              protein_coding            Tomm5
Sugp2              protein_coding            Sugp2
Plac8              protein_coding            Plac8
Tmed7              protein_coding            Tmed7
Utp3               protein_coding             Utp3
Itsn1              protein_coding            Itsn1
              ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND ENSEMBL.SEQNAME
Smchd1                    71344489           71475343              17
C130026I21Rik             84992690           85270566               1
Pbxip1                    89436706           89450952               3
Mxd4                      34173887           34187720               5
Tomm5                     45105208           45108114               4
Sugp2                     70234226           70279915               8
Plac8                    100553725          100572245               5
Tmed7                     46560235           46597535              18
Utp3                      88554483           88556083               5
Itsn1                     91729281           91920597              16
              ENSEMBL.SYMBOL        ENSEMBL.GENEID
Smchd1                Smchd1 ENSMUSG00000024054.14
C130026I21Rik  C130026I21Rik ENSMUSG00000052477.15
Pbxip1                Pbxip1  ENSMUSG00000042613.9
Mxd4                    Mxd4 ENSMUSG00000037235.13
Tomm5                  Tomm5  ENSMUSG00000078713.8
Sugp2                  Sugp2 ENSMUSG00000036054.15
Plac8                  Plac8 ENSMUSG00000029322.12
Tmed7                  Tmed7 ENSMUSG00000033184.14
Utp3                    Utp3  ENSMUSG00000070697.4
Itsn1                  Itsn1 ENSMUSG00000022957.20
                                                                                                       NCBI.ALIAS
Smchd1                                                4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
C130026I21Rik                                                                        4930565N07Rik; C130026I21Rik
Pbxip1                                                                                      4732463H20Rik; Pbxip1
Mxd4                                                              2810410A03Rik; Mad; Mad4; bHLHc1; bHLHc12; Mxd4
Tomm5                                                                                  1110019J04Rik; Tom5; Tomm5
Sugp2                                                                  Sfr; Sfrs14; Srs; Srsf14; mKIAA0365; Sugp2
Plac8                                                                          C15; D5Wsu111; D5Wsu111e; o; Plac8
Tmed7                                               3930401E15Rik; 5830493P14Rik; AU044611; AW545765; TRAM; Tmed7
Utp3                                        2400011K09Rik; AW557551; C87704; Crl; Crl-1; Crl1; Crlz1; Sas10; Utp3
Itsn1         AA517634; AA545208; AI316805; AI839402; AI848451; EHSH; Ehsh1; Ese; Ese1; Itsn; Sh3p; Sh3p17; Itsn1
              NCBI.ENTREZID
Smchd1                74355
C130026I21Rik        620078
Pbxip1               229534
Mxd4                  17122
Tomm5                 68512
Sugp2                234373
Plac8                231507
Tmed7                 66676
Utp3                  65961
Itsn1                 16443
                                                               NCBI.GENENAME
Smchd1                                         SMC hinge domain containing 1
C130026I21Rik                                     RIKEN cDNA C130026I21 gene
Pbxip1        pre B cell leukemia transcription factor interacting protein 1
Mxd4                                              Max dimerization protein 4
Tomm5                          translocase of outer mitochondrial membrane 5
Sugp2                                   SURP and G patch domain containing 2
Plac8                                                    placenta-specific 8
Tmed7                                transmembrane p24 trafficking protein 7
Utp3                                 UTP3 small subunit processome component
Itsn1                                  intersectin 1 (SH3 domain protein 1A)
                                                                                                                                                                                                                                                                                                                                                                                                                 NCBI.REFSEQ
Smchd1                                                                                                                                                                                                                                                                                                                                                                      NM_028887; NP_083163; XM_030250119; XP_030105979
C130026I21Rik               NM_001037909; NM_175219; NP_001032998; NP_780428; XM_006496512; XM_006496519; XM_017321879; XM_017321880; XM_017321881; XM_017321882; XM_017321884; XM_017321885; XM_030255713; XM_030255714; XM_030255715; XM_030255716; XP_006496575; XP_006496582; XP_017177368; XP_017177369; XP_017177370; XP_017177371; XP_017177373; XP_017177374; XP_030111573; XP_030111574; XP_030111575; XP_030111576
Pbxip1                                                                                                                                                                                                                                                                                                              NM_146131; NP_666243; XM_006501351; XM_006501352; XM_006501353; XP_006501414; XP_006501415; XP_006501416
Mxd4                                                                                                                                                                                                                                                                                                                                                                                                    NM_010753; NP_034883
Tomm5                                                                                                                                                                                                                                                                                                                                                                 NM_001099675; NM_001134646; NP_001093145; NP_001128118
Sugp2                                                                                                                                             NM_001168290; NM_172755; NP_001161762; NP_766343; NR_165051; NR_165052; XM_006509644; XM_006509645; XM_006509647; XM_006509648; XM_006509650; XM_011242297; XM_030243480; XP_006509707; XP_006509708; XP_006509710; XP_006509711; XP_006509713; XP_011240599; XP_030099340
Plac8                                                                                                                                                                                                                           NM_001370754; NM_139198; NP_001357683; NP_631937; XM_017320849; XM_017320850; XM_030254402; XM_030254403; XM_030254404; XP_017176338; XP_017176339; XP_030110262; XP_030110263; XP_030110264
Tmed7                                                                                                                                                                                                                                                                                                                                                                                                   NM_025698; NP_079974
Utp3                                                                                                                                                                                                                                                                                                                                                                                                    NM_023054; NP_075541
Itsn1         NM_001110275; NM_001110276; NM_010587; NP_001103745; NP_001103746; NP_034717; XM_006522931; XM_006522932; XM_006522933; XM_006522934; XM_006522935; XM_006522936; XM_006522937; XM_006522938; XM_006522939; XM_006522940; XM_011246102; XP_006522994; XP_006522995; XP_006522996; XP_006522997; XP_006522998; XP_006522999; XP_006523000; XP_006523001; XP_006523002; XP_006523003; XP_011244404; XR_001781793
                NCBI.SYMBOL      logFC  AveExpr         t
Smchd1               Smchd1 -0.7026226 6.268209 -4.820898
C130026I21Rik C130026I21Rik  1.3665635 4.257907  4.745883
Pbxip1               Pbxip1 -0.6932914 5.602468 -4.005454
Mxd4                   Mxd4 -0.5148870 6.367577 -3.939782
Tomm5                 Tomm5  0.5493919 6.028182  3.935081
Sugp2                 Sugp2 -0.5174414 6.402689 -3.857180
Plac8                 Plac8  0.7157961 5.316618  3.847158
Tmed7                 Tmed7  0.4468639 6.521476  3.810939
Utp3                   Utp3  0.5084568 6.013580  3.806581
Itsn1                 Itsn1 -0.4787556 7.097365 -3.794269
                   P.Value adj.P.Val           B
Smchd1        1.738273e-05 0.1401178  2.71208319
C130026I21Rik 2.221448e-05 0.1401178  1.40853864
Pbxip1        2.350149e-04 0.4959535  0.34966585
Mxd4          2.877926e-04 0.4959535  0.31787459
Tomm5         2.919828e-04 0.4959535  0.29407572
Sugp2         3.706401e-04 0.4959535  0.09726459
Plac8         3.821390e-04 0.4959535 -0.01026654
Tmed7         4.266384e-04 0.4959535 -0.02094337
Utp3          4.323178e-04 0.4959535 -0.04188254
Itsn1         4.487628e-04 0.4959535 -0.06645752</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC  AveExpr         t      P.Value adj.P.Val        B
Smchd1 -0.7026226 6.268209 -4.820898 1.738273e-05 0.1401178 2.712083</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>y_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests">Gene set tests</h3>
<ul>
<li>Cant use output of <code>voomLmFit()</code>, so have to re-fit model with <strong>edgeR</strong> or <code>voomWithQualityWeights()</code></li>
<li>Marnie and Sarah interested in chrX as a whole</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_X</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>y_X</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>y</span>, design <span class='op'>=</span> <span class='va'>y_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>y</span>,
  index <span class='op'>=</span> <span class='va'>y_index</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  contrast <span class='op'>=</span> <span class='va'>y_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    479 0.06680585 0.1356994        Up 0.1563 0.1563       0.2839
  FDR.Mixed
X    0.2839</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_y</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>y_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_y</span>,
  index <span class='op'>=</span> <span class='va'>y_index</span>,
  design <span class='op'>=</span> <span class='va'>y_design</span>,
  contrast <span class='op'>=</span> <span class='va'>y_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    479 0.05845511 0.1231733        Up 0.1537 0.1537       0.3138
  FDR.Mixed
X    0.3138</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>y_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y_status</span><span class='op'>[</span><span class='va'>y_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>y_fit</span>,
  status <span class='op'>=</span> <span class='va'>y_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>y_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>y_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<h1 id="male-only-analysis-of-aggregated-tech-reps">Male-only: analysis of aggregated tech reps</h1>
<h2 id="mds-2">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>ym</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>ym_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ym_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>ym_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>ym_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>ym_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-32-1.png" width="624" /></p>
</div>
<h2 id="array-weights-2">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span>, <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>ym</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_aw</span> <span class='op'>&lt;-</span> <span class='va'>ym_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ym_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ym</span><span class='op'>)</span>
<span class='va'>ym_aw</span> <span class='op'>&lt;-</span> <span class='va'>ym_aw</span><span class='op'>[</span><span class='va'>ym_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>ym_aw</span>, col <span class='op'>=</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>ym_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-2">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>ym_design</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>ym_fit</span>, <span class='va'>ym_contrasts</span><span class='op'>)</span>
<span class='va'>ym_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>ym_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ym_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     11568
Up             2</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>ym_fit</span>, status <span class='op'>=</span> <span class='va'>ym_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                     ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME
Vwf                       protein_coding              Vwf
Mt1                       protein_coding              Mt1
Tomm5                     protein_coding            Tomm5
ENSMUSG00000110545.1                                     
Raly                      protein_coding             Raly
C130026I21Rik             protein_coding    C130026I21Rik
Exosc7                    protein_coding           Exosc7
Itsn1                     protein_coding            Itsn1
2410127L17Rik             protein_coding    2410127L17Rik
Ppa1                      protein_coding             Ppa1
                     ENSEMBL.GENESEQSTART ENSEMBL.GENESEQEND
Vwf                             125546774          125686679
Mt1                              94179089           94180325
Tomm5                            45105208           45108114
ENSMUSG00000110545.1                                        
Raly                            154791096          154867261
C130026I21Rik                    84992690           85270566
Exosc7                          123113215          123136129
Itsn1                            91729281           91920597
2410127L17Rik                    18670780           18704788
Ppa1                             61648552           61674168
                     ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Vwf                                6            Vwf
Mt1                                8            Mt1
Tomm5                              4          Tomm5
ENSMUSG00000110545.1                               
Raly                               2           Raly
C130026I21Rik                      1  C130026I21Rik
Exosc7                             9         Exosc7
Itsn1                             16          Itsn1
2410127L17Rik                     19  2410127L17Rik
Ppa1                              10           Ppa1
                            ENSEMBL.GENEID
Vwf                  ENSMUSG00000001930.17
Mt1                   ENSMUSG00000031765.8
Tomm5                 ENSMUSG00000078713.8
ENSMUSG00000110545.1  ENSMUSG00000110545.1
Raly                 ENSMUSG00000027593.15
C130026I21Rik        ENSMUSG00000052477.15
Exosc7                ENSMUSG00000025785.5
Itsn1                ENSMUSG00000022957.20
2410127L17Rik        ENSMUSG00000024726.10
Ppa1                  ENSMUSG00000020089.8
                                                                                                              NCBI.ALIAS
Vwf                                                  6820430P06Rik; AI551257; B130011O06Rik; C630030D09; F8VWF; VWD; Vwf
Mt1                                                                                                 MT-; MT-I; Mt-1; Mt1
Tomm5                                                                                         1110019J04Rik; Tom5; Tomm5
ENSMUSG00000110545.1                                                                                                  NA
Raly                                                                                           AI663842; Mer; Merc; Raly
C130026I21Rik                                                                               4930565N07Rik; C130026I21Rik
Exosc7                                                                        2610002K22Rik; AV212732; mKIAA0116; Exosc7
Itsn1                AA517634; AA545208; AI316805; AI839402; AI848451; EHSH; Ehsh1; Ese; Ese1; Itsn; Sh3p; Sh3p17; Itsn1
2410127L17Rik                                                                                     2410127L17Rik; Carnmt1
Ppa1                                                                                         2010317E03Rik; P; Pyp; Ppa1
                     NCBI.ENTREZID
Vwf                          22371
Mt1                          17748
Tomm5                        68512
ENSMUSG00000110545.1            NA
Raly                         19383
C130026I21Rik               620078
Exosc7                       66446
Itsn1                        16443
2410127L17Rik                67383
Ppa1                         67895
                                                     NCBI.GENENAME
Vwf                                          Von Willebrand factor
Mt1                                              metallothionein 1
Tomm5                translocase of outer mitochondrial membrane 5
ENSMUSG00000110545.1                                            NA
Raly                           hnRNP-associated with lethal yellow
C130026I21Rik                           RIKEN cDNA C130026I21 gene
Exosc7                                         exosome component 7
Itsn1                        intersectin 1 (SH3 domain protein 1A)
2410127L17Rik                      carnosine N-methyltransferase 1
Ppa1                                 pyrophosphatase (inorganic) 1
                                                                                                                                                                                                                                                                                                                                                                                                                        NCBI.REFSEQ
Vwf                                                                                                                                                                                                                                                                                                                                                                                NM_011708; NP_035838; XM_006505918; XP_006505981
Mt1                                                                                                                                                                                                                                                                                                                                                                                NM_013602; NP_038630; XM_006530752; XP_006530815
Tomm5                                                                                                                                                                                                                                                                                                                                                                        NM_001099675; NM_001134646; NP_001093145; NP_001128118
ENSMUSG00000110545.1                                                                                                                                                                                                                                                                                                                                                                                                             NA
Raly                                                                                                                                               NM_001139511; NM_001139512; NM_001139513; NM_023130; NP_001132983; NP_001132984; NP_001132985; NP_075619; XM_006499013; XM_006499014; XM_006499015; XM_006499016; XM_017316631; XM_030248812; XP_006499076; XP_006499077; XP_006499078; XP_006499079; XP_017172120; XP_030104672
C130026I21Rik                      NM_001037909; NM_175219; NP_001032998; NP_780428; XM_006496512; XM_006496519; XM_017321879; XM_017321880; XM_017321881; XM_017321882; XM_017321884; XM_017321885; XM_030255713; XM_030255714; XM_030255715; XM_030255716; XP_006496575; XP_006496582; XP_017177368; XP_017177369; XP_017177370; XP_017177371; XP_017177373; XP_017177374; XP_030111573; XP_030111574; XP_030111575; XP_030111576
Exosc7                                                                                                                                                                                                                                                                                                                                           NM_001081188; NP_001074657; XM_006512207; XM_006512208; XP_006512270; XP_006512271
Itsn1                NM_001110275; NM_001110276; NM_010587; NP_001103745; NP_001103746; NP_034717; XM_006522931; XM_006522932; XM_006522933; XM_006522934; XM_006522935; XM_006522936; XM_006522937; XM_006522938; XM_006522939; XM_006522940; XM_011246102; XP_006522994; XP_006522995; XP_006522996; XP_006522997; XP_006522998; XP_006522999; XP_006523000; XP_006523001; XP_006523002; XP_006523003; XP_011244404; XR_001781793
2410127L17Rik                                                                                                                                                                                                                                                      NM_001377051; NM_001377052; NM_001377053; NM_001377054; NM_001377055; NM_026120; NP_001363980; NP_001363981; NP_001363982; NP_001363983; NP_001363984; NP_080396
Ppa1                                                                                                                                                                                                                                                                                                                                                                                                           NM_026438; NP_080714
                       NCBI.SYMBOL      logFC  AveExpr         t
Vwf                            Vwf  0.7830732 6.669085  4.193919
Mt1                            Mt1  1.1996610 5.540134  4.569711
Tomm5                        Tomm5  0.9160497 5.972748  4.046089
ENSMUSG00000110545.1            NA  0.6204894 6.992148  3.508461
Raly                          Raly  0.6546613 6.422241  3.310718
C130026I21Rik        C130026I21Rik  1.6779829 4.355898  4.480431
Exosc7                      Exosc7  0.6842820 6.300297  3.258117
Itsn1                        Itsn1 -0.6079125 7.208472 -3.051230
2410127L17Rik              Carnmt1  0.8598529 5.699336  3.369329
Ppa1                          Ppa1  0.5316434 6.826668  2.945792
                          P.Value  adj.P.Val           B
Vwf                  2.748556e-05 0.10600264  0.06649456
Mt1                  4.900774e-06 0.04323137 -0.57273519
Tomm5                5.219313e-05 0.15096862 -0.96707722
ENSMUSG00000110545.1 4.512771e-04 0.65265956 -1.33363449
Raly                 9.315193e-04 0.81122129 -1.97533432
C130026I21Rik        7.473011e-06 0.04323137 -2.18303874
Exosc7               1.122620e-03 0.81122129 -2.19728894
Itsn1                2.280780e-03 0.99153684 -2.44345100
2410127L17Rik        7.543355e-04 0.81122129 -2.46271228
Ppa1                 3.223429e-03 0.99153684 -2.46308035</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC  AveExpr         t  P.Value adj.P.Val         B
Smchd1 -0.3436645 6.375116 -1.514327 0.129952 0.9915368 -4.371277</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>ym_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-39-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests-1">Gene set tests</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_X</span> <span class='op'>&lt;-</span> <span class='va'>ym</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>ym_X</span><span class='op'>)</span>
<span class='va'>ym</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>ym</span>, design <span class='op'>=</span> <span class='va'>ym_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>ym</span>,
  index <span class='op'>=</span> <span class='va'>ym_index</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  contrast <span class='op'>=</span> <span class='va'>ym_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    429 0.06293706 0.06526807        Up 0.9847 0.9847       0.7422
  FDR.Mixed
X    0.7422</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_ym</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>ym</span>, <span class='va'>ym_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_ym</span>,
  index <span class='op'>=</span> <span class='va'>ym_index</span>,
  design <span class='op'>=</span> <span class='va'>ym_design</span>,
  contrast <span class='op'>=</span> <span class='va'>ym_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown     PropUp Direction PValue    FDR PValue.Mixed
X    429 0.04895105 0.07692308      Down 0.9927 0.9927       0.5589
  FDR.Mixed
X    0.5589</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ym_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ym_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ym_status</span><span class='op'>[</span><span class='va'>ym_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>ym_fit</span>,
  status <span class='op'>=</span> <span class='va'>ym_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>ym_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>ym_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-43-1.png" width="624" /></p>
</div>
<h1 id="female-only-analysis-of-aggregated-tech-reps">Female-only: analysis of aggregated tech reps</h1>
<h2 id="mds-3">MDS</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_mds</span> <span class='op'>&lt;-</span> <span class='fu'>plotMDS</span><span class='op'>(</span><span class='va'>yf</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>yf_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>yf_mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>yf_mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>, <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>smchd1_genotype_updated</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>smchd1_genotype_updated_colours</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>sex</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>sex_colours</span><span class='op'>)</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>mouse_number</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>mouse_number_colours</span><span class='op'>)</span>
<span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>
<span class='va'>p5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 1"</span><span class='op'>)</span>
<span class='va'>p6</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>lib.size</span><span class='op'>)</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>yf_df</span><span class='op'>)</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>yf_df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span>font_size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_colour_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Leading logFC dim 2"</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span> <span class='op'>+</span> <span class='va'>p4</span> <span class='op'>+</span> <span class='va'>p5</span> <span class='op'>+</span> <span class='va'>p6</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-44-1.png" width="624" /></p>
</div>
<h2 id="array-weights-3">Array weights</h2>
<ul>
<li><strong>TODO</strong>: Interpret voom plot</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_o</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>smchd1_genotype_updated</span>, <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>
<span class='co'># NOTE: Drop WT column as there are no female WT samples.</span>
<span class='va'>yf_design</span> <span class='op'>&lt;-</span> <span class='va'>yf_design</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"smchd1_genotype_updated"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf_design</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span>
  <span class='va'>yf</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-45-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_aw</span> <span class='op'>&lt;-</span> <span class='va'>yf_fit</span><span class='op'>$</span><span class='va'>targets</span><span class='op'>$</span><span class='va'>sample.weight</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>yf_aw</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>yf</span><span class='op'>)</span>
<span class='va'>yf_aw</span> <span class='op'>&lt;-</span> <span class='va'>yf_aw</span><span class='op'>[</span><span class='va'>yf_o</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>yf_aw</span>, col <span class='op'>=</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>smchd1_genotype_updated_colours</span><span class='op'>[</span><span class='va'>yf_o</span><span class='op'>]</span>, las <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-46-1.png" width="624" /></p>
</div>
<h2 id="de-analysis-3">DE analysis</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_contrasts</span> <span class='op'>&lt;-</span> <span class='fu'>makeContrasts</span><span class='op'>(</span><span class='va'>Del</span> <span class='op'>-</span> <span class='va'>Het</span>, levels <span class='op'>=</span> <span class='va'>yf_design</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'>contrasts.fit</span><span class='op'>(</span><span class='va'>yf_fit</span>, <span class='va'>yf_contrasts</span><span class='op'>)</span>
<span class='va'>yf_fit</span> <span class='op'>&lt;-</span> <span class='fu'>eBayes</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotSA</span><span class='op'>(</span><span class='va'>yf_fit</span>, main<span class='op'>=</span><span class='st'>"Final model: Mean-variance trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-47-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_dt</span> <span class='op'>&lt;-</span> <span class='fu'>decideTests</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>yf_dt</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       Del - Het
Down           0
NotSig     10860
Up             0</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span><span class='va'>yf_fit</span>, status <span class='op'>=</span> <span class='va'>yf_dt</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-48-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>           ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1          protein_coding           Smchd1             71344489
Hist1h2ab       protein_coding        Hist1h2ab             23751126
Rpl30-ps1 processed_pseudogene        Rpl30-ps1             38376807
Gm15013         protein_coding          Gm15013            139713681
Snhg3     processed_transcript            Snhg3            132348014
Hist1h2ah       protein_coding        Hist1h2ah             22035164
Gvin1           protein_coding            Gvin1            106156556
Gm19503   processed_pseudogene          Gm19503            151520447
Gm17257   processed_pseudogene          Gm17257             80507787
Gm8203    processed_pseudogene           Gm8203            116173737
          ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1              71475343              17         Smchd1
Hist1h2ab           23751598              13      Hist1h2ab
Rpl30-ps1           38377154               6      Rpl30-ps1
Gm15013            139714481               X        Gm15013
Snhg3              132353686               4          Snhg3
Hist1h2ah           22035568              13      Hist1h2ah
Gvin1              106215326               7          Gvin1
Gm19503            151520687               1        Gm19503
Gm17257             80508254               7        Gm17257
Gm8203             116174123               6         Gm8203
                 ENSEMBL.GENEID
Smchd1    ENSMUSG00000024054.14
Hist1h2ab  ENSMUSG00000061615.2
Rpl30-ps1  ENSMUSG00000057696.4
Gm15013    ENSMUSG00000098559.1
Snhg3      ENSMUSG00000085241.7
Hist1h2ah  ENSMUSG00000069302.5
Gvin1     ENSMUSG00000045868.12
Gm19503    ENSMUSG00000100551.1
Gm17257    ENSMUSG00000091989.1
Gm8203     ENSMUSG00000101878.1
                                                                    NCBI.ALIAS
Smchd1             4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
Hist1h2ab                 H2A.; H2A.1; H2a-5; H2a-53; Hist1h; Hist1h2ab; H2ac4
Rpl30-ps1                                                                   NA
Gm15013                                                      EG546380; Gm15013
Snhg3                                               Rnu1; Rnu17d; U17HG; Snhg3
Hist1h2ah                                            Hist1h; Hist1h2ah; H2ac12
Gvin1     9130002C22Rik; 9830104F22Rik; Ii; Iigs1; V; VLI; VLIG; VLIG-1; Gvin1
Gm19503                                                                     NA
Gm17257                                                    Gm17257; Ndufab1-ps
Gm8203                                                                      NA
          NCBI.ENTREZID                               NCBI.GENENAME
Smchd1            74355               SMC hinge domain containing 1
Hist1h2ab        319172                     H2A clustered histone 4
Rpl30-ps1            NA                                          NA
Gm15013       100417274   ribosomal protein S4, X-linked pseudogene
Snhg3            399101             small nucleolar RNA host gene 3
Hist1h2ah        319168                    H2A clustered histone 12
Gvin1             74558   GTPase, very large interferon inducible 1
Gm19503              NA                                          NA
Gm17257       102634451 NADH:ubiquinone oxidoreductase subunit AB1b
Gm8203               NA                                          NA
                                                                           NCBI.REFSEQ
Smchd1                                NM_028887; NP_083163; XM_030250119; XP_030105979
Hist1h2ab                                                         NM_175660; NP_783591
Rpl30-ps1                                                                           NA
Gm15013                                                                             NA
Snhg3                                                             NR_002904; NR_003270
Hist1h2ah                                                         NM_175659; NP_783590
Gvin1     NM_001039160; NM_029000; NP_001034249; NP_083276; XM_017312356; XP_017167845
Gm19503                                                                             NA
Gm17257                                                                             NA
Gm8203                                                                              NA
          NCBI.SYMBOL      logFC  AveExpr         t      P.Value
Smchd1         Smchd1 -0.9196499 6.196570 -4.564649 0.0000527059
Hist1h2ab       H2ac4  0.7377339 6.913170  4.248432 0.0001374156
Rpl30-ps1          NA  0.5558097 7.539098  4.034760 0.0002598973
Gm15013       Gm15013  0.7107823 6.271358  4.068861 0.0002349120
Snhg3           Snhg3  0.7966257 5.923613  4.117325 0.0002033935
Hist1h2ah      H2ac12  0.6396590 6.780925  3.879541 0.0004103490
Gvin1           Gvin1 -0.5816545 7.030119 -3.841977 0.0004579094
Gm19503            NA  0.8542704 6.124652  3.927357 0.0003567075
Gm17257    Ndufab1-ps  0.6848889 6.422459  3.817741 0.0004913891
Gm8203             NA  0.5199310 7.740226  3.680889 0.0007298130
          adj.P.Val          B
Smchd1    0.4789468  0.6899730
Hist1h2ab 0.4789468  0.5349589
Rpl30-ps1 0.4789468  0.1758529
Gm15013   0.4789468 -0.1197237
Snhg3     0.4789468 -0.2319699
Hist1h2ah 0.4789468 -0.3184473
Gvin1     0.4789468 -0.3651386
Gm19503   0.4789468 -0.4837861
Gm17257   0.4789468 -0.5557962
Gm8203    0.5661315 -0.6183900</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"Smchd1"</span>, <span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>       ENSEMBL.GENEBIOTYPE ENSEMBL.GENENAME ENSEMBL.GENESEQSTART
Smchd1      protein_coding           Smchd1             71344489
       ENSEMBL.GENESEQEND ENSEMBL.SEQNAME ENSEMBL.SYMBOL
Smchd1           71475343              17         Smchd1
              ENSEMBL.GENEID
Smchd1 ENSMUSG00000024054.14
                                                        NCBI.ALIAS
Smchd1 4931400A14Rik; AW554188; MommeD; MommeD1; mKIAA0650; Smchd1
       NCBI.ENTREZID                 NCBI.GENENAME
Smchd1         74355 SMC hinge domain containing 1
                                            NCBI.REFSEQ NCBI.SYMBOL
Smchd1 NM_028887; NP_083163; XM_030250119; XP_030105979      Smchd1
            logFC AveExpr         t     P.Value adj.P.Val        B
Smchd1 -0.9196499 6.19657 -4.564649 5.27059e-05 0.4789468 0.689973</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P.Value</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"P-value"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span>
  <span class='fu'>topTable</span><span class='op'>(</span><span class='va'>yf_fit</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.P.Val</span>,
  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>20</span> <span class='op'>/</span> <span class='fl'>20</span>,
  main <span class='op'>=</span> <span class='st'>"Adjusted P-value"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-51-1.png" width="624" /></p>
</div>
<h3 id="gene-set-tests-2">Gene set tests</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_X</span> <span class='op'>&lt;-</span> <span class='va'>yf</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>ENSEMBL.SEQNAME</span> <span class='op'>==</span> <span class='st'>"X"</span>
</code></pre>
</div>
</details>
</div>
<p>Using <strong>edgeR</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>yf_X</span><span class='op'>)</span>
<span class='va'>yf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></span><span class='op'>(</span><span class='va'>yf</span>, design <span class='op'>=</span> <span class='va'>yf_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>yf</span>,
  index <span class='op'>=</span> <span class='va'>yf_index</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  contrast <span class='op'>=</span> <span class='va'>yf_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    396 0.06565657 0.1691919        Up 0.0731 0.0731       0.1363
  FDR.Mixed
X    0.1363</code></pre>
</div>
<p>Using <code>voomWithQualityWeights()</code></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_yf</span> <span class='op'>&lt;-</span> <span class='fu'>voomWithQualityWeights</span><span class='op'>(</span><span class='va'>yf</span>, <span class='va'>yf_design</span><span class='op'>)</span>
<span class='fu'>roast</span><span class='op'>(</span>
  <span class='va'>v_yf</span>,
  index <span class='op'>=</span> <span class='va'>yf_index</span>,
  design <span class='op'>=</span> <span class='va'>yf_design</span>,
  contrast <span class='op'>=</span> <span class='va'>yf_contrasts</span>,
  nrot <span class='op'>=</span> <span class='fl'>9999</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>  NGenes   PropDown    PropUp Direction PValue    FDR PValue.Mixed
X    396 0.05808081 0.1792929        Up 0.0746 0.0746       0.0989
  FDR.Mixed
X    0.0989</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yf_status</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Other"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>yf_fit</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yf_status</span><span class='op'>[</span><span class='va'>yf_X</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"X"</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plotMD</span><span class='op'>(</span>
  <span class='va'>yf_fit</span>,
  status <span class='op'>=</span> <span class='va'>yf_status</span>,
  values <span class='op'>=</span> <span class='st'>"X"</span>,
  hl.col <span class='op'>=</span> <span class='st'>"red"</span>,
  legend <span class='op'>=</span> <span class='st'>"bottomright"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>0</span>, col <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span>

<span class='fu'>barcodeplot</span><span class='op'>(</span>
  <span class='va'>yf_fit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,
  <span class='va'>yf_X</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Down in Del"</span>, <span class='st'>"Up in Del"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="C086_Kinkel.multi-sample_comparisons.UMIs_files/figure-html5/unnamed-chunk-55-1.png" width="624" /></p>
</div>
<h1 id="todos">TODOs</h1>
<ul>
<li><input type="checkbox" disabled="" />
Exclude pseudogenes and all that crap?</li>
<li><input type="checkbox" disabled="" />
Compare gene lists from analysis of <code>x</code> and <code>y</code></li>
<li><input type="checkbox" disabled="" />
Help interpreting flick in voom plot and plotSA plot</li>
<li><input type="checkbox" disabled="" />
Quantile normalize with/without</li>
</ul>
<h1 id="session-info" class="appendix">Session info</h1>
<summary>The analysis and this document were prepared using the following software (click triangle to expand)</summary>
<details>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sessioninfo</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sessioninfo/man/session_info.html'>session_info</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> Session info 
 setting  value                       
 version  R version 4.0.3 (2020-10-10)
 os       CentOS Linux 7 (Core)       
 system   x86_64, linux-gnu           
 ui       X11                         
 language (EN)                        
 collate  en_US.UTF-8                 
 ctype    en_US.UTF-8                 
 tz       Australia/Melbourne         
 date     2021-03-31                  

 Packages 
 ! package              * version  date       lib source        
 P assertthat             0.2.1    2019-03-21 [?] CRAN (R 4.0.0)
 P Biobase              * 2.50.0   2020-10-27 [?] Bioconductor  
 P BiocGenerics         * 0.36.0   2020-10-27 [?] Bioconductor  
 P bitops                 1.0-6    2013-08-17 [?] CRAN (R 4.0.0)
 P cli                    2.3.1    2021-02-23 [?] CRAN (R 4.0.3)
 P colorspace             2.0-0    2020-11-11 [?] CRAN (R 4.0.3)
 P cowplot              * 1.1.1    2020-12-30 [?] CRAN (R 4.0.3)
 P crayon                 1.4.1    2021-02-08 [?] CRAN (R 4.0.3)
 P DBI                    1.1.1    2021-01-15 [?] CRAN (R 4.0.3)
 P DelayedArray           0.16.1   2021-01-22 [?] Bioconductor  
 P digest                 0.6.27   2020-10-24 [?] CRAN (R 4.0.2)
 P distill                1.2      2021-01-13 [?] CRAN (R 4.0.3)
 P downlit                0.2.1    2020-11-04 [?] CRAN (R 4.0.3)
 P dplyr                  1.0.4    2021-02-02 [?] CRAN (R 4.0.3)
 P edgeR                * 3.32.1   2021-01-14 [?] Bioconductor  
 P ellipsis               0.3.1    2020-05-15 [?] CRAN (R 4.0.0)
 P evaluate               0.14     2019-05-28 [?] CRAN (R 4.0.0)
 P fansi                  0.4.2    2021-01-15 [?] CRAN (R 4.0.3)
 P farver                 2.0.3    2020-01-16 [?] CRAN (R 4.0.0)
 P generics               0.1.0    2020-10-31 [?] CRAN (R 4.0.3)
 P GenomeInfoDb         * 1.26.2   2020-12-08 [?] Bioconductor  
 P GenomeInfoDbData       1.2.4    2020-10-20 [?] Bioconductor  
 P GenomicRanges        * 1.42.0   2020-10-27 [?] Bioconductor  
 P ggplot2              * 3.3.3    2020-12-30 [?] CRAN (R 4.0.3)
 P ggrepel              * 0.9.1    2021-01-15 [?] CRAN (R 4.0.3)
 P glue                   1.4.2    2020-08-27 [?] CRAN (R 4.0.0)
 P gtable                 0.3.0    2019-03-25 [?] CRAN (R 4.0.0)
 P here                 * 1.0.1    2020-12-13 [?] CRAN (R 4.0.3)
 P highr                  0.8      2019-03-20 [?] CRAN (R 4.0.0)
 P htmltools              0.5.1.1  2021-01-22 [?] CRAN (R 4.0.3)
 P IRanges              * 2.24.1   2020-12-12 [?] Bioconductor  
 P knitr                  1.31     2021-01-27 [?] CRAN (R 4.0.3)
 P labeling               0.4.2    2020-10-20 [?] CRAN (R 4.0.0)
 P lattice                0.20-41  2020-04-02 [3] CRAN (R 4.0.3)
 P lifecycle              1.0.0    2021-02-15 [?] CRAN (R 4.0.3)
 P limma                * 3.46.0   2020-10-27 [?] Bioconductor  
 P locfit                 1.5-9.4  2020-03-25 [?] CRAN (R 4.0.0)
 P magrittr               2.0.1    2020-11-17 [?] CRAN (R 4.0.3)
 P Matrix                 1.2-18   2019-11-27 [3] CRAN (R 4.0.3)
 P MatrixGenerics       * 1.2.1    2021-01-30 [?] Bioconductor  
 P matrixStats          * 0.58.0   2021-01-29 [?] CRAN (R 4.0.3)
 P munsell                0.5.0    2018-06-12 [?] CRAN (R 4.0.0)
 P patchwork            * 1.1.1    2020-12-17 [?] CRAN (R 4.0.3)
 P pillar                 1.5.0    2021-02-22 [?] CRAN (R 4.0.3)
 P pkgconfig              2.0.3    2019-09-22 [?] CRAN (R 4.0.0)
 P purrr                  0.3.4    2020-04-17 [?] CRAN (R 4.0.0)
 P R6                     2.5.0    2020-10-28 [?] CRAN (R 4.0.2)
 P Rcpp                   1.0.6    2021-01-15 [?] CRAN (R 4.0.3)
 P RCurl                  1.98-1.2 2020-04-18 [?] CRAN (R 4.0.0)
 P rlang                  0.4.10   2020-12-30 [?] CRAN (R 4.0.3)
 P rmarkdown              2.7      2021-02-19 [?] CRAN (R 4.0.3)
 P rprojroot              2.0.2    2020-11-15 [?] CRAN (R 4.0.3)
 P S4Vectors            * 0.28.1   2020-12-09 [?] Bioconductor  
 P scales                 1.1.1    2020-05-11 [?] CRAN (R 4.0.0)
 P sessioninfo            1.1.1    2018-11-05 [?] CRAN (R 4.0.0)
 P SingleCellExperiment * 1.12.0   2020-10-27 [?] Bioconductor  
 P statmod                1.4.35   2020-10-19 [?] CRAN (R 4.0.2)
 P stringi                1.5.3    2020-09-09 [?] CRAN (R 4.0.0)
 P stringr                1.4.0    2019-02-10 [?] CRAN (R 4.0.0)
 P SummarizedExperiment * 1.20.0   2020-10-27 [?] Bioconductor  
 P tibble                 3.0.6    2021-01-29 [?] CRAN (R 4.0.3)
 P tidyselect             1.1.0    2020-05-11 [?] CRAN (R 4.0.0)
 P utf8                   1.1.4    2018-05-24 [?] CRAN (R 4.0.0)
 P vctrs                  0.3.6    2020-12-17 [?] CRAN (R 4.0.3)
 P viridisLite            0.3.0    2018-02-01 [?] CRAN (R 4.0.0)
 P withr                  2.4.1    2021-01-26 [?] CRAN (R 4.0.3)
 P xfun                   0.21     2021-02-10 [?] CRAN (R 4.0.3)
 P XVector                0.30.0   2020-10-27 [?] Bioconductor  
 P yaml                   2.2.1    2020-02-01 [?] CRAN (R 4.0.0)
 P zlibbioc               1.36.0   2020-10-27 [?] Bioconductor  

[1] /stornext/Projects/score/Analyses/C086_Kinkel/renv/library/R-4.0/x86_64-pc-linux-gnu
[2] /tmp/RtmpuiV8yk/renv-system-library
[3] /stornext/System/data/apps/R/R-4.0.3/lib64/R/library

 P  Loaded and on-disk path mismatch.</code></pre>
</div>
</details>
<div class="sourceCode" id="cb24"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
